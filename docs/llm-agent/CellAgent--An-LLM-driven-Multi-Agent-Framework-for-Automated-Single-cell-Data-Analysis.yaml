- en: <!--yml
  id: totrans-0
  prefs: []
  type: TYPE_NORMAL
  zh: <!--yml
- en: 'category: 未分类'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 类别：未分类
- en: 'date: 2024-09-08 18:41:37'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 日期：2024-09-08 18:41:37
- en: -->
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: -->
- en: 'CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell Data
    Analysis'
  id: totrans-4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 'CellAgent: 一个基于 LLM 的多代理框架用于自动化单细胞数据分析'
- en: 来源：[https://ar5iv.labs.arxiv.org/html/2407.09811](https://ar5iv.labs.arxiv.org/html/2407.09811)
  id: totrans-5
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 来源：[https://ar5iv.labs.arxiv.org/html/2407.09811](https://ar5iv.labs.arxiv.org/html/2407.09811)
- en: \equalcont
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: \equalcont
- en: These authors contributed equally to this work. \equalcontThese authors contributed
    equally to this work. \equalcontThese authors contributed equally to this work.
    \equalcontThese authors contributed equally to this work. [2]\fnmJianye \surHao
    [1,3]\fnmJiajie \surPeng
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 这些作者对这项工作贡献相同。 \equalcont这些作者对这项工作贡献相同。 \equalcont这些作者对这项工作贡献相同。 \equalcont这些作者对这项工作贡献相同。
    [2]\fnmJianye \surHao [1,3]\fnmJiajie \surPeng
- en: '[1]\orgdivAI for Science Interdisciplinary Research Center, \orgnameSchool
    of Computer Science, Northwestern Polytechnical University, \orgaddress\streetNo.1
    Dongxiang Road, \cityXi’an, \countryChina 2]\orgdivCollege of Intelligence and
    Computing, \orgnameTianjin University, \orgaddress\streetNo.92 Weijin Road, \cityTianjin,
    \countryChina'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '[1]\orgdiv科学人工智能跨学科研究中心，\orgname计算机科学学院，西北工业大学，\orgaddress\streetNo.1 东巷路，\city西安，\country中国
    2]\orgdiv智能与计算学院，\orgname天津大学，\orgaddress\streetNo.92 卫津路，\city天津，\country中国'
- en: '[3]\orgdivKey Laboratory of Big Data Storage and Management, Northwestern Polytechnical
    University, Ministry of Industry and Information Technology, \orgaddress\streetNo.1
    Dongxiang Road, \cityXi’an, \countryChina'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '[3]\orgdiv大数据存储与管理重点实验室，西北工业大学，工业和信息化部，\orgaddress\streetNo.1 东巷路，\city西安，\country中国'
- en: \fnmYihang \surXiao    \fnmJinyi \surLiu    \fnmYan \surZheng    \fnmXiaohan
    \surXie    [jianye.hao@tju.edu.cn](mailto:jianye.hao@tju.edu.cn)    \fnmMingzhi
    \surLi    \fnmRuitao \surWang    \fnmFei \surNi    \fnmYuxiao \surLi    \fnmJintian
    \surLuo    \fnmShaoqing \surJiao    [jiajiepeng@nwpu.edu.cn](mailto:jiajiepeng@nwpu.edu.cn)
    * [ *
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: \fnmYihang \surXiao    \fnmJinyi \surLiu    \fnmYan \surZheng    \fnmXiaohan
    \surXie    [jianye.hao@tju.edu.cn](mailto:jianye.hao@tju.edu.cn)    \fnmMingzhi
    \surLi    \fnmRuitao \surWang    \fnmFei \surNi    \fnmYuxiao \surLi    \fnmJintian
    \surLuo    \fnmShaoqing \surJiao    [jiajiepeng@nwpu.edu.cn](mailto:jiajiepeng@nwpu.edu.cn)
    * [ *
- en: Abstract
  id: totrans-11
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
  zh: 摘要
- en: Single-cell RNA sequencing (scRNA-seq) data analysis is crucial for biological
    research, as it enables the precise characterization of cellular heterogeneity.
    However, manual manipulation of various tools to achieve desired outcomes can
    be labor-intensive for researchers. To address this, we introduce CellAgent ([http://cell.agent4science.cn/](http://cell.agent4science.cn/)),
    an LLM-driven multi-agent framework, specifically designed for the automatic processing
    and execution of scRNA-seq data analysis tasks, providing high-quality results
    with no human intervention. Firstly, to adapt general LLMs to the biological field,
    CellAgent constructs LLM-driven biological expert roles—planner, executor, and
    evaluator—each with specific responsibilities. Then, CellAgent introduces a hierarchical
    decision-making mechanism to coordinate these biological experts, effectively
    driving the planning and step-by-step execution of complex data analysis tasks.
    Furthermore, we propose a self-iterative optimization mechanism, enabling CellAgent
    to autonomously evaluate and optimize solutions, thereby guaranteeing output quality.
    We evaluate CellAgent on a comprehensive benchmark dataset encompassing dozens
    of tissues and hundreds of distinct cell types. Evaluation results consistently
    show that CellAgent effectively identifies the most suitable tools and hyperparameters
    for single-cell analysis tasks, achieving optimal performance. This automated
    framework dramatically reduces the workload for science data analyses, bringing
    us into the “Agent for Science” era.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 单细胞 RNA 测序（scRNA-seq）数据分析对生物研究至关重要，因为它能够精确描述细胞异质性。然而，手动操作各种工具以实现预期结果可能对研究人员来说非常繁琐。为了解决这个问题，我们推出了
    CellAgent ([http://cell.agent4science.cn/](http://cell.agent4science.cn/))，这是一个基于
    LLM 的多代理框架，专门设计用于自动处理和执行 scRNA-seq 数据分析任务，提供高质量的结果，无需人工干预。首先，为了使通用 LLM 适应生物领域，CellAgent
    构建了 LLM 驱动的生物专家角色——规划者、执行者和评估者——每个角色都有特定的职责。然后，CellAgent 引入了一个分层决策机制来协调这些生物专家，有效推动复杂数据分析任务的规划和逐步执行。此外，我们提出了一个自我迭代优化机制，使
    CellAgent 能够自主评估和优化解决方案，从而保证输出质量。我们在一个包含数十种组织和数百种不同细胞类型的综合基准数据集上评估了 CellAgent。评估结果一致显示，CellAgent
    能够有效识别最适合单细胞分析任务的工具和超参数，取得了最佳性能。这个自动化框架显著减少了科学数据分析的工作量，带我们进入了“科学代理”时代。
- en: 1 Introduction
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1 引言
- en: Single-cell RNA sequencing (scRNA-seq) techniques have transformed molecular
    biology by allowing for the analysis of transcriptome profiles with unprecedented
    scale and precision [[1](#bib.bib1)]. Such advances have driven large-scale innovations
    in computational methods, resulting in over 1400 tools currently available for
    analyzing scRNA-seq data from various perspectives  [[2](#bib.bib2)]. These tools,
    including computational frameworks and software libraries [[3](#bib.bib3), [4](#bib.bib4),
    [5](#bib.bib5)], coupled with method benchmarks and best practice workflows [[6](#bib.bib6),
    [7](#bib.bib7)], lead to groundbreaking discoveries in biology [[8](#bib.bib8),
    [9](#bib.bib9)].
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 单细胞 RNA 测序（scRNA-seq）技术通过允许以前所未有的规模和精度分析转录组数据，彻底改变了分子生物学[[1](#bib.bib1)]。这些进展推动了计算方法的大规模创新，目前已有超过
    1400 种工具可用于从不同角度分析 scRNA-seq 数据[[2](#bib.bib2)]。这些工具包括计算框架和软件库[[3](#bib.bib3),
    [4](#bib.bib4), [5](#bib.bib5)]，以及方法基准和最佳实践工作流程[[6](#bib.bib6), [7](#bib.bib7)]，从而在生物学领域取得了突破性发现[[8](#bib.bib8),
    [9](#bib.bib9)]。
- en: However, analyzing scRNA-seq data entails considerable complexity and demands
    specialized knowledge and expertise. The steps involved may include preprocessing,
    batch correction, clustering, marker gene visualization, cell type annotation,
    and trajectory inference, among others. To complete these steps, researchers must
    carefully execute a series of corresponding tools while configuring appropriate
    hyperparameters and models tailored to the specific characteristics of the biological
    data [[7](#bib.bib7)]. This requires researchers to possess not only advanced
    programming skills but also a strong biological background, further increasing
    the cost of conducting single-cell analysis tasks. Therefore, there is an urgent
    need for an intelligent tool capable of automatically assembling and executing
    existing tools to generate analysis results for scRNA-seq data. Such an automated
    tool could significantly reduce the technical barriers in the field of biology
    and remove obstacles in data analysis for biological scientists.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，分析 scRNA-seq 数据涉及相当的复杂性，并且需要专业的知识和技能。相关步骤可能包括预处理、批次校正、聚类、标记基因可视化、细胞类型注释和轨迹推断等。完成这些步骤需要研究人员仔细执行一系列相应的工具，同时配置适合特定生物数据特征的超参数和模型[[7](#bib.bib7)]。这要求研究人员不仅具备高级编程技能，还需拥有扎实的生物学背景，进一步增加了进行单细胞分析任务的成本。因此，迫切需要一种能够自动组装和执行现有工具以生成
    scRNA-seq 数据分析结果的智能工具。这种自动化工具可以显著降低生物学领域的技术障碍，并消除生物科学家在数据分析中的障碍。
- en: 'Recently, with the remarkable capabilities demonstrated by large language models
    (LLMs) [[10](#bib.bib10), [11](#bib.bib11), [12](#bib.bib12)], there has been
    growing research interest in LLM-driven autonomous AI agents capable of automatically
    handling tasks, such as MetaGPT [[13](#bib.bib13)] for software programming and
    Microsoft Copilot [[14](#bib.bib14)] for office suite assistance. These AI agents
    typically employ LLMs as the core of the agent’s brain, supplemented by necessary
    mechanisms such as memory and tools to expand their capabilities [[15](#bib.bib15),
    [16](#bib.bib16), [17](#bib.bib17)]. Inspired by these advancements, a novel question
    arises: How to employ LLMs to design a biologically proficient agent framework
    for automating single-cell data analysis tasks?'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 最近，随着大型语言模型（LLMs）所展示出的卓越能力[[10](#bib.bib10), [11](#bib.bib11), [12](#bib.bib12)]，对于能够自动处理任务的
    LLM 驱动的自主 AI 代理的研究兴趣日益增加，例如用于软件编程的 MetaGPT [[13](#bib.bib13)] 和用于办公套件辅助的 Microsoft
    Copilot [[14](#bib.bib14)]。这些 AI 代理通常将 LLM 作为代理核心的大脑，辅以必要的机制，如记忆和工具，以扩展其能力[[15](#bib.bib15),
    [16](#bib.bib16), [17](#bib.bib17)]。受这些进展的启发，提出了一个新问题：如何利用 LLM 设计一个生物学上有效的代理框架，以自动化单细胞数据分析任务？
- en: Applying LLMs directly to complex scRNA-seq data analysis poses significant
    challenges. General LLMs lack comprehensive and accurate knowledge of specialized
    biological tools and concepts, leading to outputs that may lack reasonable biological
    significance. Moreover, LLMs struggle to comprehend the lengthy context involved
    in multi-step tasks, easily losing crucial information. Nevertheless, LLMs are
    unaware of these deficiencies, resulting in unreliable outcomes. Therefore, to
    develop specialized approaches that effectively integrate LLMs’ strengths with
    the specific requirements of scRNA-seq data analysis is crucial, for achieving
    efficient, professional, and automated task execution.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 直接将LLMs应用于复杂的scRNA-seq数据分析面临着显著的挑战。通用LLMs缺乏对专业生物工具和概念的全面且准确的知识，导致输出结果可能缺乏合理的生物学意义。此外，LLMs在理解多步骤任务中的冗长上下文方面也存在困难，容易丢失关键信息。然而，LLMs并未意识到这些不足，导致结果不可靠。因此，开发能够有效结合LLMs优势与scRNA-seq数据分析具体需求的专门方法至关重要，以实现高效、专业且自动化的任务执行。
- en: 'In this paper, to address the aforementioned challenges, we propose a specialized,
    zero-code CellAgent, an LLM-driven multi-agent collaborative framework for scRNA-seq
    data analysis. CellAgent can directly comprehend natural language task descriptions,
    completing complex tasks with high quality through effective collaboration, autonomously.
    Firstly, considering the limitations of LLMs in understanding biological expertise,
    we manually gather a few crucial expert experiences and tools. Three types of
    biological expert roles driven by LLM are established: Planner, Executor, and
    Evaluator. To enhance the stability of the execution process and avoid handling
    lengthy steps in a single pass, CellAgent introduces a hierarchical decision-making
    mechanism, with upper-level task planning via Planner, and lower-level task execution
    via Executor. Furthermore, to guarantee high-quality solution outputs from CellAgent,
    we propose a self-iterative optimization mechanism, encouraging Executors to autonomously
    optimize the planning process by incorporating automated evaluation results and
    accounting for potential code execution exceptions. The Evaluator plays a crucial
    role in driving the iterative optimization process, possessing the ability to
    assess the quality of task solutions from a biological expert’s perspective. Through
    the effective collaboration of these biological experts, CellAgent finally possesses
    robust capabilities for automated scRNA-seq data analysis. Without requiring human
    intervention, CellAgent enables the end-to-end automatic execution of the entire
    workflow, ensuring the quality of output results effectively.'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在本文中，为了应对上述挑战，我们提出了一种专门的零代码CellAgent，即一个由LLM驱动的多代理协作框架，用于scRNA-seq数据分析。CellAgent可以直接理解自然语言任务描述，通过有效的协作，自动高质量地完成复杂任务。首先，考虑到LLMs在理解生物专业知识方面的局限性，我们手动收集了一些关键的专家经验和工具。建立了三种由LLM驱动的生物专家角色：规划者（Planner）、执行者（Executor）和评估者（Evaluator）。为了增强执行过程的稳定性并避免一次性处理冗长步骤，CellAgent引入了一个分层决策机制，通过规划者进行上层任务规划，通过执行者进行下层任务执行。此外，为了确保CellAgent输出的解决方案具有高质量，我们提出了一种自我迭代优化机制，鼓励执行者通过整合自动化评估结果并考虑潜在的代码执行异常来自主优化规划过程。评估者在驱动迭代优化过程方面发挥了关键作用，具备从生物专家的角度评估任务解决方案质量的能力。通过这些生物专家的有效协作，CellAgent最终具备了强大的自动化scRNA-seq数据分析能力。CellAgent能够实现整个工作流程的端到端自动执行，无需人工干预，有效保证输出结果的质量。
- en: We have developed a benchmark comprising more than 50 single-cell datasets,
    comprising dozens of tissues and encompassing hundreds of distinct cell types,
    encompassing both normal and disease samples. Experimental results on 22 datasets
    with expert-annotated labels demonstrate that CellAgent consistently achieves
    robust performance, matching or surpassing the performance levels of several best
    tools. On the entire dataset, CellAgent completes tasks in 92% of cases, more
    than doubling the task completion rate compared to direct utilization of GPT-4.
    This innovative approach offers a robust automated solution for data processing
    and analysis in single-cell transcriptomics research, substantially lowering the
    technical and financial barriers to entry. Also, CellAgent has the potential to
    be extensively applied in more biomedical research fields, driving more accurate
    and comprehensive biological discoveries.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 我们开发了一个基准数据集，包含了50多个单细胞数据集，涉及几十种组织和数百种不同的细胞类型，包括正常样本和疾病样本。对22个数据集进行的专家标注结果表明，CellAgent
    一直能够实现稳定的性能，与几款最佳工具的性能相当或超过。在整个数据集上，CellAgent 在92%的情况下完成了任务，这一完成率比直接使用 GPT-4 的完成率提高了两倍多。这一创新方法为单细胞转录组学研究的数据处理和分析提供了一个稳健的自动化解决方案，显著降低了技术和财务门槛。此外，CellAgent
    还具有在更多生物医学研究领域广泛应用的潜力，推动更准确和全面的生物学发现。
- en: '![Refer to caption](img/7caac168fb21af7b947f3c5689ae425b.png)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![参考说明](img/7caac168fb21af7b947f3c5689ae425b.png)'
- en: 'Figure 1: Schematic of the CellAgent Framework. a, Example of user input received
    by the CellAgent, comprising single-cell data and user-provided text information.
    b, Upon receiving user input, the Planner role first parses user intent and decomposes
    the task into subtasks. c, Illustration of final results, including results of
    individual subtasks and the final task outcome. d, Detailed view of the CellAgent’s
    processing flow for subtasks. The current subtask and historical code memory are
    inputted to an Executor, which initially retrieves tools and outputs available
    tools for this step. Subsequently, corresponding documentation for these tools
    is acquired, and the Executor derives solutions (text analysis and code generation)
    based on the documentation. These codes are executed in the code sandbox, and
    if exceptions are encountered, solutions are regenerated until successful execution
    of this task. Then, the Evaluator assesses the results of the current task and
    allows the Executor to optimize solutions. Ultimately, based on its evaluation
    of results under multiple solutions, the Evaluator aggregates results to obtain
    the final outcome of this step.'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 图 1：CellAgent 框架示意图。a，CellAgent 接收到的用户输入示例，包括单细胞数据和用户提供的文本信息。b，收到用户输入后，规划者角色首先解析用户意图并将任务分解为子任务。c，最终结果的示意图，包括各个子任务的结果和最终任务结果。d，CellAgent
    对子任务的处理流程的详细视图。当前子任务和历史代码记忆输入到执行器中，执行器首先检索工具并输出可用于此步骤的工具。随后，获取这些工具的相应文档，执行器基于文档推导解决方案（文本分析和代码生成）。这些代码在代码沙箱中执行，如果遇到异常，则重新生成解决方案，直到任务成功执行。然后，评估者评估当前任务的结果，并允许执行器优化解决方案。最终，基于对多种解决方案结果的评估，评估者汇总结果以获得此步骤的最终结果。
- en: 2 Results
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2 结果
- en: 2.1 A multi-agent collaborative automated workflow for single-cell RNA-seq analysis
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.1 单细胞 RNA-seq 分析的多智能体协作自动化工作流程
- en: 'The process of scRNA-seq data analysis is inherently complex and diverse. For
    analyzing a single-cell dataset, tools and parameters are usually required to
    be manually optimized. The optimal tools and parameters often vary among different
    datasets. To address this challenge, we introduce CellAgent, an LLM-driven sophisticated
    AI agent specialized in automating the entire workflow of scRNA-seq data analysis.
    CellAgent receives data along with a task description in natural language from
    the user as inputs (Figure [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")a).
    Subsequently, CellAgent executes a series of automated processes, including task
    decomposition (Fig. [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent: An LLM-driven
    Multi-Agent Framework for Automated Single-cell Data Analysis")b), sequential
    execution and optimization of subtasks (Fig. [1](#S1.F1 "Figure 1 ‣ 1 Introduction
    ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell Data
    Analysis")c), and finally delivers the task results to the user (Fig. [1](#S1.F1
    "Figure 1 ‣ 1 Introduction ‣ CellAgent: An LLM-driven Multi-Agent Framework for
    Automated Single-cell Data Analysis")d).'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 'scRNA-seq 数据分析的过程本质上复杂且多样化。对于分析单细胞数据集，通常需要手动优化工具和参数。最佳工具和参数往往在不同的数据集之间有所不同。为应对这一挑战，我们引入了
    CellAgent，一个 LLM 驱动的复杂 AI 代理，专门用于自动化 scRNA-seq 数据分析的整个工作流程。CellAgent 接收来自用户的自然语言数据和任务描述作为输入（图
    [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent: An LLM-driven Multi-Agent Framework
    for Automated Single-cell Data Analysis")a）。随后，CellAgent 执行一系列自动化流程，包括任务分解（图 [1](#S1.F1
    "Figure 1 ‣ 1 Introduction ‣ CellAgent: An LLM-driven Multi-Agent Framework for
    Automated Single-cell Data Analysis")b）、子任务的顺序执行和优化（图 [1](#S1.F1 "Figure 1 ‣ 1
    Introduction ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell
    Data Analysis")c），最终将任务结果交付给用户（图 [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")d）。'
- en: To enhance the use of LLMs in the context of scRNA-seq data analysis tasks and
    incorporate domain-specific biological knowledge, we design three distinct LLM-driven
    biological expert roles, including Planner, Executor and Evaluator. Then, CellAgent
    effectively organizes the collaboration of these expert roles, through a hierarchical
    decision-making framework and a self-iterative optimization mechanism. Such efficient
    collaboration enables each role to fulfill its responsibilities, facilitating
    effective information exchange and collectively achieving high-quality task completion.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 为了增强 LLM 在 scRNA-seq 数据分析任务中的应用并融合领域特定的生物知识，我们设计了三个不同的 LLM 驱动的生物专家角色，包括计划者、执行者和评估者。然后，CellAgent
    通过层级决策框架和自我迭代优化机制有效组织这些专家角色的协作。这种高效的协作使每个角色能够履行其职责，促进有效的信息交换，并共同实现高质量的任务完成。
- en: 'Planner: To ensure the rational decomposition and step-by-step resolution of
    complex scRNA-seq data analysis tasks, similar to the process employed by human
    experts in data analysis, CellAgent introduces a hierarchical decision-making
    framework. With a precise understanding of the whole workflows related to scRNA-seq
    data analysis tasks, Planner firstly conducts higher-level planning based on user-provided
    data and requirements (Fig. [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")b).
    The Planner possesses the ability to comprehend natural language instructions
    from the user accurately, identify data features, and design task plans judiciously.
    This plan includes necessary data preprocessing tasks such as quality control,
    high variable gene selection, and normalization, as well as potentially required
    analysis steps such as batch effect correction, cell type annotation, and so on.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '计划者：为了确保对复杂的 scRNA-seq 数据分析任务进行合理的分解和逐步解决，类似于数据分析领域专家的处理过程，CellAgent 引入了一个层级决策框架。计划者首先根据用户提供的数据和需求进行高级规划，全面理解与
    scRNA-seq 数据分析任务相关的整个工作流程（图 [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")b）。计划者具备准确理解用户自然语言指令、识别数据特征和明智地设计任务计划的能力。该计划包括必要的数据预处理任务，如质量控制、高变基因选择和归一化，以及可能需要的分析步骤，如批次效应校正、细胞类型注释等。'
- en: 'Executor: Then, as shown in Fig. [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")d,
    the lower-level Executors are responsible for sequentially executing the decomposed
    subtasks, providing detailed analysis and executable code. Notably, these executors
    possess a comprehensive understanding of the specific methodologies and tools
    utilized in scRNA-seq data analysis tasks, and they can acquire documentation
    for these tools, thereby mitigating code execution failures. If execution exceptions
    are detected, CellAgent will request Executor to resolve the issue until successful
    code execution is achieved.'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 执行器：然后，如图 [1](#S1.F1 "图 1 ‣ 1 引言 ‣ CellAgent：一个基于 LLM 的多代理框架，用于自动化单细胞数据分析")d
    所示，低级执行器负责顺序执行拆分后的子任务，提供详细的分析和可执行代码。值得注意的是，这些执行器对 scRNA-seq 数据分析任务中使用的具体方法和工具有全面的了解，并且可以获取这些工具的文档，从而减轻代码执行失败的风险。如果检测到执行异常，CellAgent
    将请求执行器解决问题，直到成功执行代码为止。
- en: 'Evaluator: Evaluator is responsible for assessing the quality of current results
    of specific data processing tasks akin to human experts, providing judgments on
    the effectiveness of various methods. Building upon effective execution of generated
    code, CellAgent proposes a self-iterative optimization mechanism to ensure the
    rationality of this solution. Specifically, based on self-evaluation results or
    potential code exceptions, Executor automatically optimizes the solutions through
    hyperparameter tuning or tool selection, leading to iterative improvement of outcomes.
    Finally, according to the Evaluator’s judgment, CellAgent outputs the best solution
    and corresponding result for this step.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 评估器：评估器负责评估当前特定数据处理任务结果的质量，类似于人工专家，提供对各种方法效果的判断。在生成代码有效执行的基础上，CellAgent 提出了一种自我迭代优化机制，以确保解决方案的合理性。具体而言，基于自我评估结果或潜在的代码异常，执行器通过超参数调整或工具选择自动优化解决方案，从而实现结果的迭代改进。最后，根据评估器的判断，CellAgent
    输出最佳解决方案和该步骤的相应结果。
- en: 'To assess the performance of CellAgent, we conduct detailed evaluations in
    handling specific tasks: batch effect correction, cell type annotation, and trajectory
    inference. Our findings reveal that in the majority of cases, the outcomes yielded
    by CellAgent surpass those generated by other existing tools (Sec. 2.2-2.4). This
    elucidates that CellAgent, through effective collaboration among multiple LLM-driven
    agents, achieves the automation of the scRNA-seq data analysis. The automation
    process above encompasses tool invocation, code generation, code execution, exception
    handling, result evaluation, and solution optimization in a closed-loop fashion,
    culminating in the generation of reliable outcomes. To demonstrate the broader
    applicability of CellAgent across a spectrum of scRNA-seq data analysis tasks,
    we perform a thorough comparison using various types of datasets. The results
    show a remarkable comprehensive completion rate of 92% for CellAgent, doubling
    the performance of the GPT-4 model alone. Furthermore, CellAgent also outperforms
    other scRNA-seq data analysis tools across various tasks.'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估 CellAgent 的性能，我们对处理特定任务进行了详细评估：批量效应校正、细胞类型注释和轨迹推断。我们的发现表明，在大多数情况下，CellAgent
    生成的结果超越了其他现有工具的结果 （第 2.2-2.4 节）。这阐明了 CellAgent 通过多个 LLM 驱动的代理的有效协作，实现了 scRNA-seq
    数据分析的自动化。上述自动化过程包括工具调用、代码生成、代码执行、异常处理、结果评估和解决方案优化，以闭环方式进行，最终生成可靠的结果。为了展示 CellAgent
    在各种 scRNA-seq 数据分析任务中的广泛适用性，我们使用各种数据集进行了彻底比较。结果显示，CellAgent 的综合完成率达到 92%，是单独使用
    GPT-4 模型性能的两倍。此外，CellAgent 还在各种任务中超越了其他 scRNA-seq 数据分析工具。
- en: '![Refer to caption](img/f124b1324906996d7858b596342a0873.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![参见图注](img/f124b1324906996d7858b596342a0873.png)'
- en: 'Figure 2: Batch Correction. a, The performance of CellAgent and other batch
    correction algorithms on batch correction, bio-conservation, and overall scores,
    along with their programming languages. b, Violin plot shows the distribution
    of overall score between CellAgent and other methods across all datasets. c, The
    ranking of CellAgent and other methods across different datasets. d, UMAP plots
    show the performance of CellAgent on the heart datasets, using batch labels and
    cell type labels for coloring respectively.'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 图2：批次校正。a、CellAgent和其他批次校正算法在批次校正、生物保护和整体得分上的表现，以及它们的编程语言。b、小提琴图展示了CellAgent与其他方法在所有数据集上的整体得分分布。c、CellAgent和其他方法在不同数据集上的排名。d、UMAP图展示了CellAgent在心脏数据集上的表现，分别使用批次标签和细胞类型标签进行着色。
- en: 2.2 CellAgent enables efficient batch correction
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.2 CellAgent实现了高效的批次校正
- en: Batch correction aims to eliminate non-biological variations in datasets from
    different batches, which stem from differences in experimental conditions, sample
    handling, or sequencing platforms. These batch effects can obscure or distort
    the actual biological signals [[18](#bib.bib18)]. Therefore, batch correction
    is a crucial step in single-cell analysis.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 批次校正旨在消除来自不同批次的数据集中的非生物学变异，这些变异源于实验条件、样本处理或测序平台的差异。这些批次效应可能会掩盖或扭曲实际的生物学信号 [[18](#bib.bib18)]。因此，批次校正是单细胞分析中的关键步骤。
- en: To evaluate the performance of CellAgent on batch correction, we applied it
    to nine datasets [[19](#bib.bib19)], covering major tissues or organs in the human
    body. We compared CellAgent with five advanced methods, including scVI [[20](#bib.bib20)],
    LIGER [[21](#bib.bib21)], Scanorama [[22](#bib.bib22)], Harmony [[23](#bib.bib23)]
    and Combat [[24](#bib.bib24)]. Ten metrics are used to evaluate these methods
    on their ability to remove batch effects while conserving biological variation.
    Among these metrics, some are for the removal of batch effects (batch correction),
    such as kBET [[25](#bib.bib25)] and $iLISI_{Graph}$ [[26](#bib.bib26)] and ARI [[27](#bib.bib27)].
    The overall score, derived from averaging ten metrics, serves as the final performance
    indicator [[18](#bib.bib18)].
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估CellAgent在批次校正上的表现，我们将其应用于九个数据集 [[19](#bib.bib19)]，覆盖了人体主要组织或器官。我们将CellAgent与五种先进方法进行了比较，包括scVI [[20](#bib.bib20)]、LIGER [[21](#bib.bib21)]、Scanorama [[22](#bib.bib22)]、Harmony [[23](#bib.bib23)]和Combat [[24](#bib.bib24)]。使用了十个指标来评估这些方法在去除批次效应的同时保持生物学变异的能力。在这些指标中，有些用于去除批次效应（批次校正），如kBET [[25](#bib.bib25)]、$iLISI_{Graph}$ [[26](#bib.bib26)]和ARI [[27](#bib.bib27)]。从十个指标中平均得到的整体得分作为最终的性能指标 [[18](#bib.bib18)]。
- en: 'The results indicate that CellAgent achieved top scores in both batch correction
    and bio-conservation (Fig. [2](#S2.F2 "Figure 2 ‣ 2.1 A multi-agent collaborative
    automated workflow for single-cell RNA-seq analysis ‣ 2 Results ‣ CellAgent: An
    LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")a).
    The average overall score of CellAgent reached 0.684 across multiple datasets.
    CellAgent outperformed the suboptimal method, scVI scoring 0.642\. CellAgent achieved
    the most favorable distribution of overall scores compared with other methods,
    by observing the quantiles and density estimation curve of the violin plot (Fig. [2](#S2.F2
    "Figure 2 ‣ 2.1 A multi-agent collaborative automated workflow for single-cell
    RNA-seq analysis ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework
    for Automated Single-cell Data Analysis")b). The overall scores of CellAgent on
    different datasets are more concentrated, with a median of approximately 0.69,
    surpassing those of other methods. Additionally, CellAgent ranked first on four
    datasets, which demonstrated its advantage (Fig. [2](#S2.F2 "Figure 2 ‣ 2.1 A
    multi-agent collaborative automated workflow for single-cell RNA-seq analysis
    ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell
    Data Analysis")c). The UMAP plots show that CellAgent removed the batch effect
    while preserving true cell types in the clustering result (Fig. [2](#S2.F2 "Figure
    2 ‣ 2.1 A multi-agent collaborative automated workflow for single-cell RNA-seq
    analysis ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated
    Single-cell Data Analysis")d). Cells of the same type, such as ventricle-enriched
    pericytes cells, myeloid cells, and stromal pericytes cells, from different batches
    are mixed together.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: '结果表明，CellAgent 在批次校正和生物保存方面均取得了最高分（图 [2](#S2.F2 "Figure 2 ‣ 2.1 A multi-agent
    collaborative automated workflow for single-cell RNA-seq analysis ‣ 2 Results
    ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell Data
    Analysis")a）。CellAgent 在多个数据集上的平均总分达到了 0.684。CellAgent 的表现优于表现不佳的方法 scVI，其得分为
    0.642。通过观察小提琴图的分位数和密度估计曲线（图 [2](#S2.F2 "Figure 2 ‣ 2.1 A multi-agent collaborative
    automated workflow for single-cell RNA-seq analysis ‣ 2 Results ‣ CellAgent: An
    LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")b），CellAgent
    在总体得分分布上表现最为有利。CellAgent 在不同数据集上的总体得分更加集中，中位数约为 0.69，超过了其他方法。此外，CellAgent 在四个数据集上排名第一，展示了其优势（图
    [2](#S2.F2 "Figure 2 ‣ 2.1 A multi-agent collaborative automated workflow for
    single-cell RNA-seq analysis ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent
    Framework for Automated Single-cell Data Analysis")c）。UMAP 图显示，CellAgent 在保留真实细胞类型的同时消除了批次效应（图
    [2](#S2.F2 "Figure 2 ‣ 2.1 A multi-agent collaborative automated workflow for
    single-cell RNA-seq analysis ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent
    Framework for Automated Single-cell Data Analysis")d）。来自不同批次的相同类型细胞，如心室富集的周细胞、髓样细胞和基质周细胞被混合在一起。'
- en: '![Refer to caption](img/c79ca316ef7aa6b7a2b0d307a640fdee.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![参见说明](img/c79ca316ef7aa6b7a2b0d307a640fdee.png)'
- en: 'Figure 3: Cell Type Annotation a, The mean accuracy of cell type annotation
    results with labeled cell types, derived from samples of five distinct human tissues
    and mouse tissues. b, The accuracy of cell type annotation for the 17 clusters
    of human PBMC dataset. c, Detailed cell-type annotations of the human PBMC dataset
    with the CellAgent and expert-annotated cell type Annotations. d, Visualize the
    expression of LILR4A gene (PDCs marker) and CD79A gene(B cells marker) across
    clusters using UMAP plots and violin plots.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3：细胞类型注释 a、基于五种不同人类组织和小鼠组织样本的标记细胞类型的细胞类型注释结果的平均准确率。b、人类 PBMC 数据集 17 个簇的细胞类型注释准确率。c、使用
    CellAgent 和专家注释的细胞类型注释对人类 PBMC 数据集的详细细胞类型注释。d、使用 UMAP 图和小提琴图可视化 LILR4A 基因（PDCs
    标记）和 CD79A 基因（B 细胞标记）在各个簇中的表达。
- en: 2.3 CellAgent facilitates more accurate cell type annotation
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.3 CellAgent 促进了更准确的细胞类型注释
- en: Cell type annotation is a critical yet often time-consuming precursor step in
    the analysis of scRNA-seq data  [[28](#bib.bib28)]. Various tools have been developed
    for automated cell type annotation. However, these tools exhibit poor generalization
    capabilities, often performing well only on data from specific tissues or organs
    while performing poorly in others.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 细胞类型注释是 scRNA-seq 数据分析中的一个关键但通常耗时的前置步骤 [[28](#bib.bib28)]。已开发出各种工具用于自动化细胞类型注释。然而，这些工具的通用性较差，通常只能在特定组织或器官的数据上表现良好，而在其他数据上表现较差。
- en: 'We conducted benchmarking tests on the performance of seven different methods
    in terms of their ability to correctly assign cell type annotations. The datasets
    used in the benchmarking originated from various tissues, including Human Peripheral
    Blood Mononuclear Cells [[29](#bib.bib29)], Human Liver [[30](#bib.bib30)], Human
    Lung [[31](#bib.bib31)], Human Pancreas [[32](#bib.bib32)], and Mouse Retina [[33](#bib.bib33)].
    The diversity of these datasets allowed us to evaluate CellAgent and other methods
    across different sequencing platforms, tissue types, and organisms. CellAgent
    showed superior performance in terms of average accuracy across all datasets (Fig. [3](#S2.F3
    "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction ‣ 2 Results ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")a).'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: '我们对七种不同方法在正确分配细胞类型注释方面的性能进行了基准测试。这些基准测试使用的数据集来源于不同的组织，包括人类外周血单核细胞[[29](#bib.bib29)]、人类肝脏[[30](#bib.bib30)]、人类肺脏[[31](#bib.bib31)]、人类胰腺[[32](#bib.bib32)]和小鼠视网膜[[33](#bib.bib33)]。这些数据集的多样性使我们能够在不同的测序平台、组织类型和生物体中评估CellAgent及其他方法。CellAgent在所有数据集中的平均准确性方面表现优越（图[3](#S2.F3
    "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction ‣ 2 Results ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")a）。'
- en: 'For example, CellAgent showed high accuracy on the human PMBC dataset, where
    there exist multiple similar subtypes. We evaluated the consistency between the
    CellAgent annotations and expert annotations of seventeen clusters in this dataset.
    Following the evaluation metric in [[28](#bib.bib28)], we categorized the results
    as ‘fully match’, ‘partially match’, and ‘mismatch’, assigning scores of 1, 0.5,
    and 0 respectively to each category. The annotation accuracy, revealing that CellAgent
    achieved ‘fully match’ labeling in ten out of seventeen clusters, ‘partially match’
    results in five clusters, and only one cluster with an ‘mismatch’ labeling result.
    Our model annotated 94% clusters of the PBMC dataset effectively, achieving a
    high level of accuracy (Fig. [3](#S2.F3 "Figure 3 ‣ 2.2 CellAgent enables efficient
    batch correction ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework
    for Automated Single-cell Data Analysis")b). The visualization of the annotation
    results on the human PBMC dataset, including a comparison with expert-annotated
    results, also demonstrates the annotations with CellAgent are close to the true
    cell type labels (Fig. [3](#S2.F3 "Figure 3 ‣ 2.2 CellAgent enables efficient
    batch correction ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework
    for Automated Single-cell Data Analysis")c and Supplementary FigX).'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '例如，CellAgent在存在多个相似亚型的人类PMBC数据集上表现出高准确性。我们评估了CellAgent注释与专家注释在该数据集的十七个簇之间的一致性。根据[[28](#bib.bib28)]中的评估指标，我们将结果分为“完全匹配”、“部分匹配”和“不匹配”，并分别为每个类别分配了1、0.5和0的分数。注释准确性显示，CellAgent在十七个簇中实现了十个“完全匹配”标记，五个“部分匹配”结果，以及一个“不匹配”标记结果。我们的模型有效注释了PBMC数据集的94%簇，达到了高水平的准确性（图[3](#S2.F3
    "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction ‣ 2 Results ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")b）。对人类PBMC数据集上的注释结果进行的可视化，包括与专家注释结果的比较，也表明CellAgent的注释接近真实细胞类型标签（图[3](#S2.F3
    "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction ‣ 2 Results ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")c
    和补充图X）。'
- en: 'In scRNA-seq data analysis, visualizing the expression of specific genes within
    each cluster or cell type is crucial. These visualizations are essential for understanding
    the underlying biological mechanisms. Given a specific genes, CellAgent also provides
    the function of generating gene expression umap plots and violin plots for users
    (Fig. [3](#S2.F3 "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction
    ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell
    Data Analysis")d).'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: '在scRNA-seq数据分析中，视觉化每个簇或细胞类型中特定基因的表达至关重要。这些可视化对于理解潜在的生物学机制是必要的。给定特定基因，CellAgent还提供了为用户生成基因表达umap图和小提琴图的功能（图[3](#S2.F3
    "Figure 3 ‣ 2.2 CellAgent enables efficient batch correction ‣ 2 Results ‣ CellAgent:
    An LLM-driven Multi-Agent Framework for Automated Single-cell Data Analysis")d）。'
- en: 2.4 CellAgent enhances the performance of trajectory inference
  id: totrans-43
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 2.4 CellAgent增强了轨迹推断的性能
- en: '![Refer to caption](img/8187b827e747a92e38269eb1870184bc.png)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
  zh: '![参见说明](img/8187b827e747a92e38269eb1870184bc.png)'
- en: 'Figure 4: Trajectory Inference. a, Comparison of the performance between CellAgent
    and other trajectory inference algorithms on gold standard datasets, along with
    their programming languages. b, Radar charts display the performance of CellAgent
    and other methods on the metrics, which are not covered in a. c, CellAgent’s output
    on the “aging hsc kowalczyk” dataset. one UMAP plot depicting trajectories colored
    by original cell types, another colored by cell type clusters optimized based
    on milestones within the trajectory, and the last colored by pseudo time. d, Heatmap
    of gene expression, with additional emphasis on the expression of milestones within
    the trajectory. The cell order in the heatmap is optimized according to the trajectory.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4：轨迹推断。a，CellAgent 与其他轨迹推断算法在黄金标准数据集上的性能比较，以及它们的编程语言。b，雷达图展示了 CellAgent 和其他方法在
    a 部分未覆盖的指标上的性能。c，CellAgent 在“aging hsc kowalczyk”数据集上的输出。一个 UMAP 图展示了按原始细胞类型着色的轨迹，另一个按基于轨迹内里程碑优化的细胞类型簇着色，最后一个按伪时间着色。d，基因表达的热图，特别强调轨迹内里程碑的表达。热图中的细胞顺序根据轨迹进行了优化。
- en: Trajectory inference is employed to decode the temporal sequences of cell development
    and differentiation. It can reconstruct developmental trajectories from static
    single-cell data, unveil transitions between cell states, and identify changes
    in various biological properties over time [[34](#bib.bib34)]. This is crucial
    for understanding the mechanisms that determine cell fate and the associated complex
    biological processes. Although new trajectory inference algorithms have emerged
    in recent years, they are typically suited to specific datasets or topological
    structures [[35](#bib.bib35)]. Selecting the appropriate trajectory inference
    algorithm for researchers and discerning its biological significance remain both
    challenging and valuable.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 轨迹推断用于解码细胞发展和分化的时间序列。它可以从静态单细胞数据中重建发育轨迹，揭示细胞状态之间的过渡，并识别各种生物特性随时间的变化[[34](#bib.bib34)]。这对于理解决定细胞命运的机制及其相关的复杂生物过程至关重要。尽管近年来出现了新的轨迹推断算法，但它们通常适用于特定的数据集或拓扑结构[[35](#bib.bib35)]。选择合适的轨迹推断算法对于研究人员来说仍然具有挑战性和价值，同时也能洞察其生物学意义。
- en: Through experiments conducted on nine datasets with gold-standard trajectories
    (see Datasets section) [[34](#bib.bib34)]. We compared the performance between
    CellAgent and the other five trajectory inference methods, including Raceid stmid [[36](#bib.bib36)],
    Scorpius [[37](#bib.bib37)], Paga, Page tree [[38](#bib.bib38)], and Slingshot [[39](#bib.bib39)].
    Following previous study [[34](#bib.bib34)], we utilized $\mathit{cor}_{\textrm{dist}}$
    to measure topological similarity, branch matching, cellular position distances,
    and correlation of trajectory-specific genes for trajectory evaluation. The weighted
    average score of these metrics is used to measure the final performance [[34](#bib.bib34)].
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 通过在九个具有黄金标准轨迹的数据集上进行实验（见数据集部分）[[34](#bib.bib34)]。我们比较了 CellAgent 与其他五种轨迹推断方法的性能，包括
    Raceid stmid [[36](#bib.bib36)]、Scorpius [[37](#bib.bib37)]、Paga、Page tree [[38](#bib.bib38)]
    和 Slingshot [[39](#bib.bib39)]。根据之前的研究[[34](#bib.bib34)]，我们利用 $\mathit{cor}_{\textrm{dist}}$
    来测量拓扑相似性、分支匹配、细胞位置距离以及轨迹特异性基因的相关性以进行轨迹评估。这些指标的加权平均分数用于衡量最终性能[[34](#bib.bib34)]。
- en: 'CellAgent performed best across these datasets with an overall score of 0.496
    (Fig. [4](#S2.F4 "Figure 4 ‣ 2.4 CellAgent enhances the performance of trajectory
    inference ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated
    Single-cell Data Analysis")a). It surpassed Slingshot, the suboptimal method at
    0.473\. Additionally, CellAgent demonstrated advantages in multiple other metrics [[34](#bib.bib34)]
    such as $\mathit{NMSE}_{\textit{rf}}$ (Fig. [4](#S2.F4 "Figure 4 ‣ 2.4 CellAgent
    enhances the performance of trajectory inference ‣ 2 Results ‣ CellAgent: An LLM-driven
    Multi-Agent Framework for Automated Single-cell Data Analysis")b). On the “aging
    hsc kowalczyk” dataset, CellAgent revealed the developmental trajectory from LT-HSC
    cells, through ST-HSC cells, to the final differentiation into MPP cells (Fig. [4](#S2.F4
    "Figure 4 ‣ 2.4 CellAgent enhances the performance of trajectory inference ‣ 2
    Results ‣ CellAgent: An LLM-driven Multi-Agent Framework for Automated Single-cell
    Data Analysis")c). CellAgent also depicted the changes in their gene expression
    patterns (Fig. [4](#S2.F4 "Figure 4 ‣ 2.4 CellAgent enhances the performance of
    trajectory inference ‣ 2 Results ‣ CellAgent: An LLM-driven Multi-Agent Framework
    for Automated Single-cell Data Analysis")d). The expression of the CD48 and MPO
    genes gradually increased during the differentiation process. The accuracy and
    biological interpretability indicate that CellAgent can help scientists understand
    the mechanisms determining cell fate and related biological processes.'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 'CellAgent在这些数据集中表现最佳，总体得分为0.496（图[4](#S2.F4 "图 4 ‣ 2.4 CellAgent提升了轨迹推断性能 ‣
    2 结果 ‣ CellAgent: 一个由LLM驱动的多智能体框架，用于自动化单细胞数据分析")a）。它超越了次优方法Slingshot，后者得分为0.473。此外，CellAgent在多个其他指标上表现出优势[[34](#bib.bib34)]，例如$\mathit{NMSE}_{\textit{rf}}$（图[4](#S2.F4
    "图 4 ‣ 2.4 CellAgent提升了轨迹推断性能 ‣ 2 结果 ‣ CellAgent: 一个由LLM驱动的多智能体框架，用于自动化单细胞数据分析")b）。在“aging
    hsc kowalczyk”数据集中，CellAgent揭示了从LT-HSC细胞，通过ST-HSC细胞，到最终分化为MPP细胞的发育轨迹（图[4](#S2.F4
    "图 4 ‣ 2.4 CellAgent提升了轨迹推断性能 ‣ 2 结果 ‣ CellAgent: 一个由LLM驱动的多智能体框架，用于自动化单细胞数据分析")c）。CellAgent还描绘了它们基因表达模式的变化（图[4](#S2.F4
    "图 4 ‣ 2.4 CellAgent提升了轨迹推断性能 ‣ 2 结果 ‣ CellAgent: 一个由LLM驱动的多智能体框架，用于自动化单细胞数据分析")d）。CD48和MPO基因的表达在分化过程中逐渐增加。准确性和生物学解释性表明，CellAgent可以帮助科学家理解决定细胞命运和相关生物过程的机制。'
- en: 3 Discussion
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3 讨论
- en: Single-cell RNA-seq is a powerful tool for characterizing cellular properties,
    yet it demands high efficiency and quality in advanced data analytics. In this
    paper, we introduced CellAgent, an LLM-driven automated agent specifically designed
    for single-cell analysis tasks for the first time, which enables high-quality
    and automated analysis of scRNA-seq data.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 单细胞RNA测序是表征细胞特性的强大工具，但它在高级数据分析中要求高效率和质量。本文首次介绍了CellAgent，一个由LLM驱动的自动化智能体，专门设计用于单细胞分析任务，实现了scRNA-seq数据的高质量自动分析。
- en: CellAgent is capable of automatically handling complex single-cell analysis
    tasks, with its key innovation lying in the effective collaboration among multiple
    bio-expert LLM roles. This automation capability stems from its use of powerful
    AI generative models, which are capable of understanding human natural language
    instructions and generating corresponding content. Notably, we found that GPT-4,
    a state-of-the-art LLM, has a foundational understanding of specific biological
    knowledge, including common gene markers and various single-cell analysis tasks.
    However, its limitations are evident in its propensity to confuse certain specialized
    concepts. To address this, CellAgent expands the LLM’s capability boundaries through
    a manually defined tool library and several experiential knowledge, thereby enhancing
    its proficiency in handling single-cell analysis tasks. Then, we create different
    bio-expert roles within CellAgent based on GPT-4, enabling each role to focus
    on solving specific processes. Subsequently, CellAgent enhances the efficiency
    of addressing complex tasks by connecting the task planner with various roles
    responsible for task execution through hierarchical planning. Also, by employing
    a self-iterative optimization mechanism and utilizing modules such as Tool retriever,
    Memory module, and Code sandbox, CellAgent further enhances the quality of output
    results.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 能够自动处理复杂的单细胞分析任务，其关键创新在于多个生物专家 LLM 角色的有效协作。这一自动化能力源于其使用强大的 AI 生成模型，这些模型能够理解人类自然语言指令并生成相应的内容。值得注意的是，我们发现
    GPT-4 作为一种最先进的 LLM，对特定生物知识具有基础理解，包括常见的基因标记和各种单细胞分析任务。然而，其局限性在于容易混淆某些专业概念。为了解决这一问题，CellAgent
    通过手动定义的工具库和若干经验性知识扩展了 LLM 的能力边界，从而提高了其处理单细胞分析任务的熟练程度。接着，我们在 CellAgent 中基于 GPT-4
    创建了不同的生物专家角色，使每个角色专注于解决特定的过程。随后，CellAgent 通过将任务规划者与负责任务执行的各个角色通过层级规划相连接，提升了处理复杂任务的效率。此外，通过采用自我迭代优化机制以及利用工具检索器、记忆模块和代码沙箱等模块，CellAgent
    进一步提升了输出结果的质量。
- en: It is also worth mentioning that CellAgent proposes using GPT-4V to automatically
    evaluate the results of batch correction and trajectory inference, guiding the
    self-iterative optimization process. To our knowledge, this is the first time
    a multi-modal LLM (MLLM) like GPT-4V has been applied to evaluate these results,
    as a replacement for human judgment. Additionally, CellAgent proposes the first
    attempt of using GPT-4 to effectively aggregate the results from cell type annotation
    results of different tools, obtaining a more reasonable final annotation. These
    developments provide new insights into applying LLMs (or MLLMs) to bioinformatics
    research.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 还值得一提的是，CellAgent 提出了使用 GPT-4V 自动评估批量校正和轨迹推断结果的方案，指导自我迭代优化过程。据我们了解，这是首次将类似 GPT-4V
    的多模态 LLM（MLLM）应用于评估这些结果，取代了人工判断。此外，CellAgent 首次尝试使用 GPT-4 有效汇总不同工具的细胞类型注释结果，获得更合理的最终注释。这些进展为将
    LLM（或 MLLM）应用于生物信息学研究提供了新的见解。
- en: Overall, CellAgent is a versatile, extensible, and automated tool for scRNA-seq
    data analysis. Its process of task completion does not rely on human intervention,
    greatly reducing the difficulty and cost of data analysis. Also, its open architecture
    enables users to provide specific new knowledge and tools, allowing the CellAgent
    to better align with user expectations, as an ideal assistant for researchers.
    The emergence of CellAgent not only opens up new research directions in bioinformatics
    but also expands the application of generative AI in sciences, leading to potential
    new findings and a deeper understanding of biological systems.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 总体而言，CellAgent 是一个多功能、可扩展且自动化的工具，用于 scRNA-seq 数据分析。其任务完成过程不依赖于人工干预，大大降低了数据分析的难度和成本。此外，其开放架构使用户能够提供特定的新知识和工具，使
    CellAgent 更好地符合用户期望，成为研究人员的理想助手。CellAgent 的出现不仅开辟了生物信息学的新研究方向，还扩展了生成 AI 在科学中的应用，带来了潜在的新发现和对生物系统更深入的理解。
- en: Testing on several datasets with expert-annotated labels revealed that the results
    obtained by CellAgent are, in most cases, the best among all tools, demonstrating
    the powerful ability of CellAgent to automate scRNA-seq data analysis and ensure
    quality, reaching the level of human experts. The overall evaluation indicates
    that CellAgent significantly outperforms the data analysis process involving only
    a single GPT-4 model, illustrating that this multi-agent collaboration framework
    deeply taps into the potential of GPT-4 in handling single-cell data analysis
    tasks.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在多个数据集上进行的测试显示，CellAgent 得到的结果在大多数情况下是所有工具中最佳的，展示了 CellAgent 自动化 scRNA-seq 数据分析的强大能力，并确保了质量，达到了人类专家的水平。总体评价表明，CellAgent
    在数据分析过程中显著优于仅使用单一 GPT-4 模型的情况，表明这一多代理协作框架深度挖掘了 GPT-4 在处理单细胞数据分析任务中的潜力。
- en: However, a notable limitation lies in the imperfect self-evaluation methods
    of the CellAgent. Presently, self-evaluation primarily relies on GPT-4V or GPT-4\.
    While these innovative evaluation processes contribute to self-optimization and
    ensure final effectiveness, CellAgent is limited to support a more diverse range
    of optimization directions. Therefore, when users have specific preferences regarding
    optimization goals, manual specification of evaluation processes can prompt CellAgent
    to optimize according to user expectations. Nevertheless, enabling CellAgent to
    efficiently and automatically integrate new tools provided by users to align with
    user requirements represents a valuable research direction for the next stage
    of development in AI agents for science.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，CellAgent 的自我评估方法存在一个显著的局限性。目前，自我评估主要依赖于 GPT-4V 或 GPT-4。虽然这些创新的评估过程有助于自我优化并确保最终效果，但
    CellAgent 在支持更多样化的优化方向方面存在限制。因此，当用户对优化目标有特定偏好时，手动指定评估过程可以促使 CellAgent 根据用户期望进行优化。然而，使
    CellAgent 能够高效、自动地整合用户提供的新工具以符合用户需求，代表了 AI 科学代理下一阶段发展的宝贵研究方向。
- en: 4 Methods
  id: totrans-56
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4 种方法
- en: 4.1 The composition of CellAgent
  id: totrans-57
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.1 CellAgent 的组成
- en: Facing scRNA-seq data analysis tasks, CellAgent enables automated task decomposition,
    code execution, and iterative optimization. During this process, three LLM-driven
    biological expert roles and their communication and collaboration mechanisms serve
    as the core brain of CellAgent, responsible for thinking and providing solutions.
    Besides, to achieve efficient automation, auxiliary components such as memory $\mathcal{M}$
    are essential. These components enable CellAgent to effectively manage and execute
    tasks, allowing the three biological expert roles to focus on their thinking and
    providing efficient solutions, ensuring seamless automation of the whole workflow.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 面对 scRNA-seq 数据分析任务，CellAgent 实现了自动化任务分解、代码执行和迭代优化。在这个过程中，三个由 LLM 驱动的生物专家角色及其沟通和协作机制作为
    CellAgent 的核心脑部，负责思考和提供解决方案。此外，为了实现高效的自动化，辅助组件如记忆 $\mathcal{M}$ 是必不可少的。这些组件使 CellAgent
    能够有效地管理和执行任务，使三个生物专家角色能够专注于思考和提供高效的解决方案，确保整个工作流程的无缝自动化。
- en: 4.1.1 Biological Expert Agents
  id: totrans-59
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.1.1 生物专家代理
- en: 'CellAgent comprises three distinct roles of biological expert LLMs with different
    responsibilities, including Planner, Executor, and Evaluator. To distinguish these
    roles and enhance task execution efficiency, we collect a small amount of human
    expert experience about scRNA-seq data analysis in natural language and integrate
    necessary tools, then inform different LLMs about role assignments, specific expert
    experiences, and tools, thus constructing these biological expert roles. Notably,
    the user input of CellAgent includes three aspects: the data to be processed (${D}$).'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 包含三个具有不同职责的生物专家 LLM 角色，包括规划者、执行者和评估者。为了区分这些角色并提高任务执行效率，我们收集了一小部分关于
    scRNA-seq 数据分析的专家经验，并整合了必要的工具，然后将角色分配、特定的专家经验和工具告知不同的 LLM，从而构建这些生物专家角色。值得注意的是，CellAgent
    的用户输入包括三个方面：待处理的数据（${D}$）。
- en: Planner
  id: totrans-61
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 规划者
- en: 'Planner is designed to understand user requirements and data, and provide comprehensive
    task planning. Therefore, the system prompt for the Planner ($p^{p}_{\text{sys}}$
    sub-steps according these information is:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 规划者旨在理解用户需求和数据，并提供全面的任务规划。因此，规划者的系统提示（$p^{p}_{\text{sys}}$ 子步骤根据这些信息是：
- en: '|  | $\{t_{1},t_{2},...,t_{n}\}\leftarrow\mathcal{A}^{\text{LLM}}_{p}(p^{p}_{\text{sys}},u_{\text{task}},u_{\text{req}},u_{D},\psi(D)).$
    |  | (1) |'
  id: totrans-63
  prefs: []
  type: TYPE_TB
  zh: '|  | $\{t_{1},t_{2},...,t_{n}\}\leftarrow\mathcal{A}^{\text{LLM}}_{p}(p^{p}_{\text{sys}},u_{\text{task}},u_{\text{req}},u_{D},\psi(D)).$
    |  | (1) |'
- en: Executor
  id: totrans-64
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 执行者
- en: Executor agents are included in CellAgent to enhance the efficiency of specific
    task execution, with the Tool Selector solely responsible for selecting available
    tools, and Code Programmer responsible for generating code to complete the current
    task based on the tools recommended.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: Executor agents 被纳入 CellAgent 中，以提高特定任务执行的效率，其中 Tool Selector 仅负责选择可用的工具，而 Code
    Programmer 负责根据推荐的工具生成代码以完成当前任务。
- en: 'The system prompt for the Tool Selector, denoted as $p^{t}_{\text{sys}}$, which
    generate a list of available tools in this specific steps, represented as:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: Tool Selector 的系统提示，记作 $p^{t}_{\text{sys}}$，生成该特定步骤中的可用工具列表，表示为：
- en: '|  | $\mathcal{T}_{t_{i}}\leftarrow\mathcal{A}^{\text{LLM}}_{t}(p^{t}_{\text{sys}},u_{\text{req}},\mathcal{T},t_{i}).$
    |  | (2) |'
  id: totrans-67
  prefs: []
  type: TYPE_TB
  zh: '|  | $\mathcal{T}_{t_{i}}\leftarrow\mathcal{A}^{\text{LLM}}_{t}(p^{t}_{\text{sys}},u_{\text{req}},\mathcal{T},t_{i}).$
    |  | (2) |'
- en: 'The system prompt for the Code Programmer ($p^{c}_{\text{sys}}$, as:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: Code Programmer 的系统提示为 ($p^{c}_{\text{sys}}$)，如：
- en: '|  | $(c_{i},w_{i})\leftarrow\mathcal{A}^{\text{LLM}}_{c}(p^{c}_{\text{sys}},u_{\text{req}},u_{D},\mathcal{M},t_{i},\text{Doc}(\mathcal{T}_{t_{i}})).$
    |  | (3) |'
  id: totrans-69
  prefs: []
  type: TYPE_TB
  zh: '|  | $(c_{i},w_{i})\leftarrow\mathcal{A}^{\text{LLM}}_{c}(p^{c}_{\text{sys}},u_{\text{req}},u_{D},\mathcal{M},t_{i},\text{Doc}(\mathcal{T}_{t_{i}})).$
    |  | (3) |'
- en: Then, the code $c_{i}$.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，代码 $c_{i}$。
- en: Evaluator
  id: totrans-71
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: Evaluator
- en: 'Evaluator is tasked with assessing the results of the current step and choosing
    the best among the multiple outcomes produced by the Executor’s self-optimization.
    The system prompt for the Evaluator ($p^{e}_{\text{sys}}$. Then, the process of
    the Evaluator evaluating and selecting the optimal solution code for the current
    step can be represented as:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: Evaluator 的任务是评估当前步骤的结果，并在执行者的自我优化产生的多个结果中选择最佳结果。Evaluator 的系统提示为 ($p^{e}_{\text{sys}}$)。然后，Evaluator
    评估并选择当前步骤的最佳解决方案代码的过程可以表示为：
- en: '|  | $1$2 |  | (4) |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '|  | $1$2 |  | (4) |'
- en: 4.1.2 Auxiliary components
  id: totrans-74
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.1.2 辅助组件
- en: Memory Control
  id: totrans-75
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 内存控制
- en: LLMs do not have the capability to retain historical messages, which necessitates
    incorporating a memory module in LLM-driven Agents. By organizing past information
    rationally through the memory module, LLMs can prevent forgetting previous content
    during planning and process long contexts more efficiently. In CellAgent, the
    internal logic of different subtask processing is mutually independent, meaning
    that each subtask execution process does not need to perceive the internal processing
    of previous steps, such as tool selection, code exception handling, or intermediate
    code generated during iteration. Therefore, CellAgent defines both global memory
    and local memory, storing historical information efficiently. This enables different
    LLM roles to access proper valuable historical information, boosting LLM inference
    efficiency.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: LLMs 不具备保留历史消息的能力，这就需要在 LLM 驱动的代理中引入内存模块。通过合理组织过去的信息，LLMs 可以防止在规划过程中遗忘先前的内容，并更高效地处理长上下文。在
    CellAgent 中，不同子任务处理的内部逻辑是相互独立的，这意味着每个子任务执行过程无需感知之前步骤的内部处理，例如工具选择、代码异常处理或迭代过程中生成的中间代码。因此，CellAgent
    定义了全局内存和局部内存，以高效地存储历史信息。这使得不同 LLM 角色能够访问适当的有价值的历史信息，从而提升 LLM 推理效率。
- en: 'As shown in Fig. [1](#S1.F1 "Figure 1 ‣ 1 Introduction ‣ CellAgent: An LLM-driven
    Multi-Agent Framework for Automated Single-cell Data Analysis")d, we define global
    memory to store only the final code of each historical step, which can be represented
    as $\mathcal{M}\leftarrow\{\bar{c_{1}},\bar{c_{2}},...\}$. This allows the Executor
    to generate new code more effectively, reducing redundant work, and increasing
    code generation accuracy. We use code as a memory storage medium, which has high
    information entropy in scRNA-seq data analysis, enabling the transfer of comprehensive
    information with fewer tokens, reducing LLM costs, and improving LLM efficiency.'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 如图 [1](#S1.F1 "图 1 ‣ 1 介绍 ‣ CellAgent：一个基于LLM的多代理框架用于自动化单细胞数据分析") 所示，我们定义全局内存以仅存储每个历史步骤的最终代码，可以表示为
    $\mathcal{M}\leftarrow\{\bar{c_{1}},\bar{c_{2}},...\}$。这使得执行者能够更有效地生成新代码，减少冗余工作，提高代码生成的准确性。我们使用代码作为内存存储介质，这在
    scRNA-seq 数据分析中具有高信息熵，能够以更少的标记传递全面的信息，减少 LLM 成本，提高 LLM 效率。
- en: Within each subtask processing, the Executor maintains a local memory that only
    retains dialogue information within the current step and resets it when the subtask
    ends. The local memory enables the Executor to perceive the entire self-optimization
    process, including each generated correct or incorrect code snippet, potential
    error messages, and optimization processes. This helps avoid repeated errors during
    optimization, improving processing efficiency.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 在每个子任务处理过程中，执行器保持一个本地内存，仅保留当前步骤的对话信息，并在子任务结束时重置它。本地内存使执行器能够感知整个自我优化过程，包括每个生成的正确或错误代码片段、潜在的错误消息以及优化过程。这有助于避免在优化过程中出现重复错误，提高处理效率。
- en: Tool Retrieval
  id: totrans-79
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 工具检索
- en: CellAgent integrates multiple tools for single-cell analysis tasks to ensure
    operational stability. This integration is primarily facilitated by the Tool Retrieval
    module, denoted as $\mathcal{T}$. The integrated tools are registered within the
    CellAgent framework, allowing the Tool Selector to detect their presence and retrieve
    a list of potentially useful tools for Code Programmer at the beginning of each
    subtask. Additionally, in our implementation, the Tool classes are equipped with
    standardized documentation, known as docstrings in Python. This feature enables
    the Executor to access documentation for the selected tools, enhancing the accuracy
    of code generation.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 集成了多种工具以确保单细胞分析任务的操作稳定性。这一集成主要通过工具检索模块 $\mathcal{T}$ 实现。集成的工具在 CellAgent
    框架中注册，允许工具选择器在每个子任务开始时检测其存在并检索潜在有用工具的列表。此外，在我们的实现中，工具类配备了标准化文档，即 Python 中的 docstrings。这一功能使执行器能够访问所选工具的文档，从而提高代码生成的准确性。
- en: Code Sandbox
  id: totrans-81
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: 代码沙箱
- en: To ensure the security and reliability of code execution, CellAgent implements
    a Code Sandbox, isolating the code generated by LLMs for execution. Specifically,
    this is achieved through Jupyter Notebook Conversion (`nbconvert`), wherein data
    loading and each step of code generated by LLMs are executed within a comprehensive
    Jupyter notebook. This implementation approach decouples the CellAgent framework’s
    running and code execution of single-cell data analysis, enhancing the security
    of executing generated code. Additionally, it facilitates result management for
    single-cell task analysis tasks and reproducibility.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 为了确保代码执行的安全性和可靠性，CellAgent 实现了一个代码沙箱，隔离由 LLM 生成的代码进行执行。具体来说，这是通过 Jupyter Notebook
    转换（`nbconvert`）实现的，其中数据加载和 LLM 生成的每一步代码都在一个全面的 Jupyter notebook 中执行。这种实现方式将 CellAgent
    框架的运行与单细胞数据分析的代码执行解耦，从而提高了执行生成代码的安全性。此外，它还便于管理单细胞任务分析任务的结果和可重复性。
- en: 4.2 Self-iterative Optimization via Self-evaluation
  id: totrans-83
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.2 自我迭代优化通过自我评估
- en: 4.2.1 Preprocessing
  id: totrans-84
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.2.1 预处理
- en: CellAgent first processes the data by removing low-quality cells and genes,
    subsequently identifies highly variable genes. Then, the Evaluator checks the
    effectiveness of these preprocessing steps, optimizes the preprocessing code to
    fit the characteristics of the dataset better, and showing proper visual plots
    to users. Unless specified by the user, CellAgent is required to execute a single
    iteration by default of self-optimization for preprocessing step.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 首先通过去除低质量的细胞和基因来处理数据，随后识别出高度变异的基因。然后，评估器检查这些预处理步骤的有效性，优化预处理代码以更好地适应数据集的特征，并向用户展示适当的可视化图表。除非用户另有指定，CellAgent
    默认执行单次自我优化迭代以进行预处理步骤。
- en: 4.2.2 Batch Correction
  id: totrans-86
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.2.2 批量修正
- en: CellAgent utilizes an iterative optimization approach to produce the best batch
    correction result by assessing the outcomes of different methods through UMAP
    plots. Specifically, the Evaluator, integrated with GPT-4v, evaluates these plots
    and ranks these methods. By default, the iteration count is set to three, indicating
    that the self-optimization process will yield three distinct batch correction
    results. Following evaluation, the method with the highest score will be selected
    as the final output.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 利用迭代优化方法，通过评估不同方法的 UMAP 图来生成最佳的批量修正结果。具体来说，评估器与 GPT-4v 集成，评估这些图表并对这些方法进行排名。默认情况下，迭代次数设置为三次，这意味着自我优化过程将生成三种不同的批量修正结果。在评估之后，得分最高的方法将被选为最终输出。
- en: 4.2.3 Cell Type Annotation
  id: totrans-88
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.2.3 细胞类型注释
- en: CellAgent employs both database-based annotation tools, such as CellMarker 2.0
    and ACT, and gene expression-based tools, including CellTypist, SCSA, ScType,
    and GPT-4, for cell type annotation. Utilizing a self-iterative optimization mechanism,
    CellAgent autonomously selects various methods to execute and obtain results.
    The Evaluator, driven by GPT-4, then aggregates these annotations and determines
    the final cell type for each cluster.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: CellAgent 使用了基于数据库的注释工具，如 CellMarker 2.0 和 ACT，以及基于基因表达的工具，包括 CellTypist、SCSA、ScType
    和 GPT-4，进行细胞类型注释。利用自我迭代优化机制，CellAgent 自主选择各种方法进行执行并获得结果。由 GPT-4 驱动的评估者随后汇总这些注释，并确定每个簇的最终细胞类型。
- en: 4.2.4 Trajectory Inference
  id: totrans-90
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.2.4 轨迹推断
- en: The evaluation of trajectory inference in CellAgent is analogous to that of
    batch correction. As trajectory information is challenging to describe directly
    through text, the Evaluator scores the visualization results of various trajectory
    inference algorithms. It then selects the highest-scoring visualization as the
    final output during the iterative optimization process. These visualizations typically
    consist of UMAP plots that depict trajectories, integrating both cell and trajectory
    information to enrich the content. Additionally, expert-written knowledge about
    trajectory inference tasks is provided to the Evaluator in the form of prompts.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在 CellAgent 中，轨迹推断的评估类似于批次校正。由于轨迹信息难以通过文本直接描述，因此评估者会对各种轨迹推断算法的可视化结果进行评分。在迭代优化过程中，评估者会选择得分最高的可视化结果作为最终输出。这些可视化通常由展示轨迹的
    UMAP 图组成，结合了细胞和轨迹信息，以丰富内容。此外，关于轨迹推断任务的专家知识以提示的形式提供给评估者。
- en: 4.3 Evaluation metrics
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 4.3 评估指标
- en: 4.3.1 Cell Type Annotation Metrics
  id: totrans-93
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.3.1 细胞类型注释指标
- en: To assess the accuracy of cell type annotations and facilitate comparisons across
    various methodologies, we employ an average scoring metric. For predicted and
    actual labels, ’fully match’ is awarded when they directly align in terms of annotation
    terms or CL cell ontology names. ’Partial match’ occurs when labels share general
    cell type category (e.g., fibroblast and stromal cell) but differ in specific
    annotations or ontology names. Conversely, ’mismatch’ is declared when there is
    discrepancy in broad cell type categories, annotations, or ontology names. We
    assign consistency scores of 1, 0.5, and 0 for ’fully match’, ’partial match’,
    and ’mismatch’, respectively [[28](#bib.bib28)]. These scores are then averaged
    across all cell types within each dataset. This average score serves as quantitative
    measure of annotation accuracy, enabling robust comparisons between different
    annotation methods and datasets. This systematic scoring approach ensures that
    researchers can objectively assess precision of cell type classifications and
    refine their analytical methods or data interpretation as needed.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 为了评估细胞类型注释的准确性，并便于不同方法之间的比较，我们使用了平均评分指标。对于预测标签和实际标签，当它们在注释术语或 CL 细胞本体名称上直接对齐时，给予“完全匹配”评分。当标签共享一般的细胞类型类别（例如，成纤维细胞和基质细胞）但在具体注释或本体名称上有所不同时，给予“部分匹配”评分。相反，当在广义细胞类型类别、注释或本体名称上存在差异时，给予“不匹配”评分。我们分别对“完全匹配”、“部分匹配”和“不匹配”赋予
    1、0.5 和 0 的一致性分数[[28](#bib.bib28)]。这些分数随后在每个数据集的所有细胞类型中进行平均。这个平均分数作为注释准确性的定量测量，能够进行不同注释方法和数据集之间的稳健比较。这种系统的评分方法确保研究人员能够客观地评估细胞类型分类的精确性，并根据需要完善他们的分析方法或数据解释。
- en: 4.3.2 Batch Correction Metrics
  id: totrans-95
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.3.2 批次校正指标
- en: Ten different metrics are employed to assess the capacity to eliminate batch
    effects while preserving biological variation. These metrics are divided into
    two categories [[18](#bib.bib18)]. The metrics representing the effectiveness
    of batch effect removal include Graph Connectivity, PCR Comparison [[18](#bib.bib18)],
    $iLISI_{Graph}$ [[18](#bib.bib18)]. The weights of these metrics respectively
    represent scores of batch correction and biological conservation. The overall
    score is the weighted average of all these metrics as the final indicator.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 采用十种不同的指标来评估消除批次效应同时保持生物变异的能力。这些指标分为两类[[18](#bib.bib18)]。表示批次效应去除效果的指标包括图连接性、PCR
    比较[[18](#bib.bib18)]、$iLISI_{Graph}$[[18](#bib.bib18)]。这些指标的权重分别代表批次校正和生物保存的得分。总体得分是所有这些指标的加权平均值，作为最终指标。
- en: 4.3.3 Trajectory Inference Metrics
  id: totrans-97
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 4.3.3 轨迹推断指标
- en: Four distinct types of metrics are employed to evaluate different aspects of
    trajectories. These metrics include $\mathit{edgeflip}$ serving as the comprehensive
    trajectory evaluation metric [[34](#bib.bib34)].
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 四种不同类型的度量指标被用于评估轨迹的不同方面。这些指标包括 $\mathit{edgeflip}$，作为综合轨迹评估指标 [[34](#bib.bib34)]。
- en: 5 Data availability
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5 数据可用性
- en: 'For the batch correction task, we utilized nine datasets from different human
    organ atlases including blood, bone marrow, heart, intestine, kidney, liver, lung,
    pancreas, and skeletal muscle. They are available at [https://www.celltypist.org/organs](https://www.celltypist.org/organs).
    We employed the following datasets for the cell type annotation task: PBMC dataset
    ([https://www.10xgenomics.com/resources/datasets/8-k-pbm-cs-from-a-healthy-donor-2-standard-2-1-0](https://www.10xgenomics.com/resources/datasets/8-k-pbm-cs-from-a-healthy-donor-2-standard-2-1-0));
    pancreas dataset including Smart-seq2, 10X Chromium, and Drop-seq ([https://hemberg-lab.github.io/scRNA.seq.datasets/human/pancreas/](https://hemberg-lab.github.io/scRNA.seq.datasets/human/pancreas/));
    multiple PBMC dataset can be obtained from Single Cell Portal and the accession
    code is SCP424; multi-Omics ([https://figshare.com/projects/Tabula_Muris_Transcriptomic_characterization_of_20_organs_and_tissues_from_Mus_musculus_at_single_cell_resolution/27733](https://figshare.com/projects/Tabula_Muris_Transcriptomic_characterization_of_20_organs_and_tissues_from_Mus_musculus_at_single_cell_resolution/27733));
    immune dataset from different donors ([https://figshare.com/ndownloader/files/25717328](https://figshare.com/ndownloader/files/25717328));
    mouse dataset from the brain region ([https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x](https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x)).
    We employed the following datasets for the trajectory inference task: the aging-hsc-old
    Kowalczyk, and aging-hsc-young Kowalczyk datasets, which encompass developmental
    trajectories of human hematopoietic stem cells; human-embryos petropoulos dataset,
    containing developmental trajectories of human embryonic cells; NKT-differentiation
    engel dataset from thymus; pancreatic-alpha-cell-maturation and cellbench-SC1,
    germline-human, cell-cycle, and stimulated-dendritic-cells-PIC datasets. These
    datasets are deposited on Zenodo ([https://doi.org/10.5281/zenodo.1443566](https://doi.org/10.5281/zenodo.1443566)).'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 对于批量校正任务，我们利用了来自不同人类器官图谱的九个数据集，包括血液、骨髓、心脏、肠道、肾脏、肝脏、肺、胰腺和骨骼肌。这些数据集可在 [https://www.celltypist.org/organs](https://www.celltypist.org/organs)
    获取。我们用于细胞类型注释任务的数据集包括：PBMC 数据集 ([https://www.10xgenomics.com/resources/datasets/8-k-pbm-cs-from-a-healthy-donor-2-standard-2-1-0](https://www.10xgenomics.com/resources/datasets/8-k-pbm-cs-from-a-healthy-donor-2-standard-2-1-0))；包含
    Smart-seq2、10X Chromium 和 Drop-seq 的胰腺数据集 ([https://hemberg-lab.github.io/scRNA.seq.datasets/human/pancreas/](https://hemberg-lab.github.io/scRNA.seq.datasets/human/pancreas/))；来自
    Single Cell Portal 的多个 PBMC 数据集，访问代码为 SCP424；多组学数据集 ([https://figshare.com/projects/Tabula_Muris_Transcriptomic_characterization_of_20_organs_and_tissues_from_Mus_musculus_at_single_cell_resolution/27733](https://figshare.com/projects/Tabula_Muris_Transcriptomic_characterization_of_20_organs_and_tissues_from_Mus_musculus_at_single_cell_resolution/27733))；来自不同供体的免疫数据集
    ([https://figshare.com/ndownloader/files/25717328](https://figshare.com/ndownloader/files/25717328))；来自脑区的小鼠数据集
    ([https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x](https://portal.brain-map.org/atlases-and-data/rnaseq/mouse-whole-cortex-and-hippocampus-10x))。我们用于轨迹推断任务的数据集包括：涵盖人类造血干细胞发育轨迹的
    aging-hsc-old 和 aging-hsc-young Kowalczyk 数据集；包含人类胚胎细胞发育轨迹的 human-embryos petropoulos
    数据集；来自胸腺的 NKT-differentiation engel 数据集；胰腺 α 细胞成熟和 cellbench-SC1、germline-human、cell-cycle
    以及 stimulated-dendritic-cells-PIC 数据集。这些数据集存储在 Zenodo 上 ([https://doi.org/10.5281/zenodo.1443566](https://doi.org/10.5281/zenodo.1443566))。
- en: References
  id: totrans-101
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 参考文献
- en: \bibcommenthead
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: \bibcommenthead
- en: 'Heumos et al. [2023] Heumos, L., Schaar, A.C., Lance, C., Litinetskaya, A.,
    Drost, F., Zappia, L., Lücken, M.D., Strobl, D.C., Henao, J., Curion, F., et al.:
    Best practices for single-cell analysis across modalities. Nature Reviews Genetics
    24(8), 550–572 (2023)'
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Heumos 等 [2023] Heumos, L., Schaar, A.C., Lance, C., Litinetskaya, A., Drost,
    F., Zappia, L., Lücken, M.D., Strobl, D.C., Henao, J., Curion, F., 等：不同模态下单细胞分析的最佳实践。Nature
    Reviews Genetics 24(8), 550–572 (2023)
- en: 'Zappia and Theis [2021] Zappia, L., Theis, F.J.: Over 1000 tools reveal trends
    in the single-cell rna-seq analysis landscape. Genome biology 22, 1–18 (2021)'
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Zappia 和 Theis [2021] Zappia, L., Theis, F.J.：超过 1000 种工具揭示了单细胞 RNA-seq 分析领域的趋势。Genome
    Biology 22, 1–18 (2021)
- en: 'Amezquita et al. [2020] Amezquita, R.A., Lun, A.T., Becht, E., Carey, V.J.,
    Carpp, L.N., Geistlinger, L., Marini, F., Rue-Albrecht, K., Risso, D., Soneson,
    C., et al.: Orchestrating single-cell analysis with bioconductor. Nature methods
    17(2), 137–145 (2020)'
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Amezquita 等 [2020] Amezquita, R.A., Lun, A.T., Becht, E., Carey, V.J., Carpp,
    L.N., Geistlinger, L., Marini, F., Rue-Albrecht, K., Risso, D., Soneson, C., 等:
    使用 bioconductor 协调单细胞分析。自然方法 17(2), 137–145 (2020)'
- en: 'Hao et al. [2021] Hao, Y., Hao, S., Andersen-Nissen, E., Mauck, W.M., Zheng,
    S., Butler, A., Lee, M.J., Wilk, A.J., Darby, C., Zager, M., et al.: Integrated
    analysis of multimodal single-cell data. Cell 184(13), 3573–3587 (2021)'
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Hao 等 [2021] Hao, Y., Hao, S., Andersen-Nissen, E., Mauck, W.M., Zheng, S.,
    Butler, A., Lee, M.J., Wilk, A.J., Darby, C., Zager, M., 等: 多模态单细胞数据的综合分析。细胞 184(13),
    3573–3587 (2021)'
- en: 'Wolf et al. [2018] Wolf, F.A., Angerer, P., Theis, F.J.: Scanpy: large-scale
    single-cell gene expression data analysis. Genome biology 19, 1–5 (2018)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Wolf 等 [2018] Wolf, F.A., Angerer, P., Theis, F.J.: Scanpy: 大规模单细胞基因表达数据分析。基因组生物学
    19, 1–5 (2018)'
- en: 'Luecken and Theis [2019] Luecken, M.D., Theis, F.J.: Current best practices
    in single-cell rna-seq analysis: a tutorial. Molecular systems biology 15(6),
    8746 (2019)'
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Luecken 和 Theis [2019] Luecken, M.D., Theis, F.J.: 单细胞 RNA-seq 分析中的当前最佳实践：一个教程。分子系统生物学
    15(6), 8746 (2019)'
- en: 'Heumos et al. [2023] Heumos, L., Schaar, A.C., Lance, C., Litinetskaya, A.,
    Drost, F., Zappia, L., Lücken, M.D., Strobl, D.C., Henao, J., Curion, F., et al.:
    Best practices for single-cell analysis across modalities. Nature Reviews Genetics,
    1–23 (2023)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Heumos 等 [2023] Heumos, L., Schaar, A.C., Lance, C., Litinetskaya, A., Drost,
    F., Zappia, L., Lücken, M.D., Strobl, D.C., Henao, J., Curion, F., 等: 跨模态单细胞分析的最佳实践。自然评论遗传学，1–23
    (2023)'
- en: 'Eraslan et al. [2022] Eraslan, G., Drokhlyansky, E., Anand, S., Fiskin, E.,
    Subramanian, A., Slyper, M., Wang, J., Van Wittenberghe, N., Rouhana, J.M., Waldman,
    J., et al.: Single-nucleus cross-tissue molecular reference maps toward understanding
    disease gene function. Science 376(6594), 4290 (2022)'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Eraslan 等 [2022] Eraslan, G., Drokhlyansky, E., Anand, S., Fiskin, E., Subramanian,
    A., Slyper, M., Wang, J., Van Wittenberghe, N., Rouhana, J.M., Waldman, J., 等:
    单核跨组织分子参考图谱，以了解疾病基因功能。科学 376(6594), 4290 (2022)'
- en: 'Sikkema et al. [2023] Sikkema, L., Ramírez-Suástegui, C., Strobl, D.C., Gillett,
    T.E., Zappia, L., Madissoon, E., Markov, N.S., Zaragosi, L.-E., Ji, Y., Ansari,
    M., et al.: An integrated cell atlas of the lung in health and disease. Nature
    Medicine, 1–15 (2023)'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Sikkema 等 [2023] Sikkema, L., Ramírez-Suástegui, C., Strobl, D.C., Gillett,
    T.E., Zappia, L., Madissoon, E., Markov, N.S., Zaragosi, L.-E., Ji, Y., Ansari,
    M., 等: 健康与疾病中肺部的综合细胞图谱。自然医学，1–15 (2023)'
- en: 'OpenAI [2023] OpenAI: GPT-4 technical report. CoRR abs/2303.08774 (2023)'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'OpenAI [2023] OpenAI: GPT-4 技术报告。CoRR abs/2303.08774 (2023)'
- en: 'Anil et al. [2023] Anil, R., Dai, A.M., Firat, O., Johnson, M., Lepikhin, D.,
    Passos, A., Shakeri, S., Taropa, E., Bailey, P., Chen, Z., Chu, E., Clark, J.H.,
    Shafey, L.E., Huang, Y., Meier-Hellstern, K., Mishra, G., Moreira, E., Omernick,
    M., Robinson, K., Ruder, S., Tay, Y., Xiao, K., Xu, Y., Zhang, Y., Ábrego, G.H.,
    Ahn, J., Austin, J., Barham, P., Botha, J.A., Bradbury, J., Brahma, S., Brooks,
    K., Catasta, M., Cheng, Y., Cherry, C., Choquette-Choo, C.A., Chowdhery, A., Crepy,
    C., Dave, S., Dehghani, M., Dev, S., Devlin, J., Díaz, M., Du, N., Dyer, E., Feinberg,
    V., Feng, F., Fienber, V., Freitag, M., Garcia, X., Gehrmann, S., Gonzalez, L.,
    al.: Palm 2 technical report. CoRR abs/2305.10403 (2023)'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Anil 等 [2023] Anil, R., Dai, A.M., Firat, O., Johnson, M., Lepikhin, D., Passos,
    A., Shakeri, S., Taropa, E., Bailey, P., Chen, Z., Chu, E., Clark, J.H., Shafey,
    L.E., Huang, Y., Meier-Hellstern, K., Mishra, G., Moreira, E., Omernick, M., Robinson,
    K., Ruder, S., Tay, Y., Xiao, K., Xu, Y., Zhang, Y., Ábrego, G.H., Ahn, J., Austin,
    J., Barham, P., Botha, J.A., Bradbury, J., Brahma, S., Brooks, K., Catasta, M.,
    Cheng, Y., Cherry, C., Choquette-Choo, C.A., Chowdhery, A., Crepy, C., Dave, S.,
    Dehghani, M., Dev, S., Devlin, J., Díaz, M., Du, N., Dyer, E., Feinberg, V., Feng,
    F., Fienber, V., Freitag, M., Garcia, X., Gehrmann, S., Gonzalez, L., 等: Palm
    2 技术报告。CoRR abs/2305.10403 (2023)'
- en: 'Touvron et al. [2023] Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
    A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava, P., Bhosale, S., Bikel, D.,
    Blecher, L., Canton-Ferrer, C., Chen, M., Cucurull, G., Esiobu, D., Fernandes,
    J., Fu, J., Fu, W., Fuller, B., Gao, C., Goswami, V., Goyal, N., Hartshorn, A.,
    Hosseini, S., Hou, R., Inan, H., Kardas, M., Kerkez, V., Khabsa, M., Kloumann,
    I., Korenev, A., Koura, P.S., Lachaux, M., Lavril, T., Lee, J., Liskovich, D.,
    Lu, Y., Mao, Y., Martinet, X., Mihaylov, T., Mishra, P., Molybog, I., Nie, Y.,
    Poulton, A., Reizenstein, J., Rungta, R., Saladi, K., Schelten, A., Silva, R.,
    Smith, E.M., Subramanian, R., Tan, X.E., Tang, B., Taylor, R., Williams, A., Kuan,
    J.X., Xu, P., Yan, Z., Zarov, I., Zhang, Y., Fan, A., Kambadur, M., Narang, S.,
    Rodriguez, A., Stojnic, R., Edunov, S., Scialom, T.: Llama 2: Open foundation
    and fine-tuned chat models. CoRR abs/2307.09288 (2023)'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Touvron et al. [2023] Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi,
    A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava, P., Bhosale, S., Bikel, D.,
    Blecher, L., Canton-Ferrer, C., Chen, M., Cucurull, G., Esiobu, D., Fernandes,
    J., Fu, J., Fu, W., Fuller, B., Gao, C., Goswami, V., Goyal, N., Hartshorn, A.,
    Hosseini, S., Hou, R., Inan, H., Kardas, M., Kerkez, V., Khabsa, M., Kloumann,
    I., Korenev, A., Koura, P.S., Lachaux, M., Lavril, T., Lee, J., Liskovich, D.,
    Lu, Y., Mao, Y., Martinet, X., Mihaylov, T., Mishra, P., Molybog, I., Nie, Y.,
    Poulton, A., Reizenstein, J., Rungta, R., Saladi, K., Schelten, A., Silva, R.,
    Smith, E.M., Subramanian, R., Tan, X.E., Tang, B., Taylor, R., Williams, A., Kuan,
    J.X., Xu, P., Yan, Z., Zarov, I., Zhang, Y., Fan, A., Kambadur, M., Narang, S.,
    Rodriguez, A., Stojnic, R., Edunov, S., Scialom, T.: Llama 2: 开放基础与微调聊天模型。CoRR
    abs/2307.09288 (2023)'
- en: 'Hong et al. [2023] Hong, S., Zhuge, M., Chen, J., Zheng, X., Cheng, Y., Zhang,
    C., Wang, J., Wang, Z., Yau, S.K.S., Lin, Z., Zhou, L., Ran, C., Xiao, L., Wu,
    C., Schmidhuber, J.: MetaGPT: Meta Programming for A Multi-Agent Collaborative
    Framework (2023)'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Hong et al. [2023] Hong, S., Zhuge, M., Chen, J., Zheng, X., Cheng, Y., Zhang,
    C., Wang, J., Wang, Z., Yau, S.K.S., Lin, Z., Zhou, L., Ran, C., Xiao, L., Wu,
    C., Schmidhuber, J.: MetaGPT: 多代理协作框架的元编程 (2023)'
- en: 'Spataro [2023] Spataro, J.: Introducing Microsoft 365 Copilot – your copilot
    for work. [https://blogs.microsoft.com/blog/2023/03/16/introducing-microsoft-365-copilot-your-copilot-for-work/](https://blogs.microsoft.com/blog/2023/03/16/introducing-microsoft-365-copilot-your-copilot-for-work/).
    Accessed: Mar 16, 2023 (2023)'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Spataro [2023] Spataro, J.: 介绍 Microsoft 365 Copilot——你的工作副驾驶。[https://blogs.microsoft.com/blog/2023/03/16/introducing-microsoft-365-copilot-your-copilot-for-work/](https://blogs.microsoft.com/blog/2023/03/16/introducing-microsoft-365-copilot-your-copilot-for-work/).
    访问日期：2023年3月16日 (2023)'
- en: 'Zhou et al. [2023] Zhou, W., Jiang, Y.E., Li, L., Wu, J., Wang, T., Qiu, S.,
    Zhang, J., Chen, J., Wu, R., Wang, S., Zhu, S., Chen, J., Zhang, W., Zhang, N.,
    Chen, H., Cui, P., Sachan, M.: Agents: An Open-source Framework for Autonomous
    Language Agents (2023)'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Zhou et al. [2023] Zhou, W., Jiang, Y.E., Li, L., Wu, J., Wang, T., Qiu, S.,
    Zhang, J., Chen, J., Wu, R., Wang, S., Zhu, S., Chen, J., Zhang, W., Zhang, N.,
    Chen, H., Cui, P., Sachan, M.: Agents: 一种用于自主语言代理的开源框架 (2023)'
- en: 'Xi et al. [2023] Xi, Z., Chen, W., Guo, X., He, W., Ding, Y., Hong, B., Zhang,
    M., Wang, J., Jin, S., Zhou, E., Zheng, R., Fan, X., Wang, X., Xiong, L., Zhou,
    Y., Wang, W., Jiang, C., Zou, Y., Liu, X., Yin, Z., Dou, S., Weng, R., Cheng,
    W., Zhang, Q., Qin, W., Zheng, Y., Qiu, X., Huan, X., Gui, T.: The rise and potential
    of large language model based agents: A survey. CoRR abs/2309.07864 (2023) [https://doi.org/10.48550/ARXIV.2309.07864](https://doi.org/10.48550/ARXIV.2309.07864)
    [2309.07864](https://arxiv.org/abs/2309.07864)'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Xi et al. [2023] Xi, Z., Chen, W., Guo, X., He, W., Ding, Y., Hong, B., Zhang,
    M., Wang, J., Jin, S., Zhou, E., Zheng, R., Fan, X., Wang, X., Xiong, L., Zhou,
    Y., Wang, W., Jiang, C., Zou, Y., Liu, X., Yin, Z., Dou, S., Weng, R., Cheng,
    W., Zhang, Q., Qin, W., Zheng, Y., Qiu, X., Huan, X., Gui, T.: 大型语言模型基础代理的崛起与潜力：一项调查。CoRR
    abs/2309.07864 (2023) [https://doi.org/10.48550/ARXIV.2309.07864](https://doi.org/10.48550/ARXIV.2309.07864)
    [2309.07864](https://arxiv.org/abs/2309.07864)'
- en: 'Wang et al. [2023] Wang, L., Ma, C., Feng, X., Zhang, Z., Yang, H., Zhang,
    J., Chen, Z., Tang, J., Chen, X., Lin, Y., Zhao, W.X., Wei, Z., Wen, J.: A survey
    on large language model based autonomous agents. CoRR abs/2308.11432 (2023) [https://doi.org/10.48550/ARXIV.2308.11432](https://doi.org/10.48550/ARXIV.2308.11432)
    [2308.11432](https://arxiv.org/abs/2308.11432)'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Wang et al. [2023] Wang, L., Ma, C., Feng, X., Zhang, Z., Yang, H., Zhang,
    J., Chen, Z., Tang, J., Chen, X., Lin, Y., Zhao, W.X., Wei, Z., Wen, J.: 关于大型语言模型基础的自主代理的调查。CoRR
    abs/2308.11432 (2023) [https://doi.org/10.48550/ARXIV.2308.11432](https://doi.org/10.48550/ARXIV.2308.11432)
    [2308.11432](https://arxiv.org/abs/2308.11432)'
- en: 'Luecken et al. [2022] Luecken, M.D., Büttner, M., Chaichoompu, K., Danese,
    A., Interlandi, M., Müller, M.F., Strobl, D.C., Zappia, L., Dugas, M., Colomé-Tatché,
    M., et al.: Benchmarking atlas-level data integration in single-cell genomics.
    Nature methods 19(1), 41–50 (2022)'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Luecken et al. [2022] Luecken, M.D., Büttner, M., Chaichoompu, K., Danese,
    A., Interlandi, M., Müller, M.F., Strobl, D.C., Zappia, L., Dugas, M., Colomé-Tatché,
    M., et al.: 单细胞基因组学中的图谱级数据整合基准测试。Nature methods 19(1), 41–50 (2022)'
- en: 'Domínguez Conde et al. [2022] Domínguez Conde, C., Xu, C., Jarvis, L., Rainbow,
    D., Wells, S., Gomes, T., Howlett, S., Suchanek, O., Polanski, K., King, H., et
    al.: Cross-tissue immune cell analysis reveals tissue-specific features in humans.
    Science 376(6594), 5197 (2022)'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Domínguez Conde 等 [2022] Domínguez Conde, C., Xu, C., Jarvis, L., Rainbow,
    D., Wells, S., Gomes, T., Howlett, S., Suchanek, O., Polanski, K., King, H., 等:
    跨组织免疫细胞分析揭示了人类特有的组织特征。Science 376(6594), 5197 (2022)'
- en: 'Lopez et al. [2018] Lopez, R., Regier, J., Cole, M.B., Jordan, M.I., Yosef,
    N.: Deep generative modeling for single-cell transcriptomics. Nature methods 15(12),
    1053–1058 (2018)'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Lopez 等 [2018] Lopez, R., Regier, J., Cole, M.B., Jordan, M.I., Yosef, N.:
    单细胞转录组的深度生成建模。Nature methods 15(12), 1053–1058 (2018)'
- en: 'Liu et al. [2020] Liu, J., Gao, C., Sodicoff, J., Kozareva, V., Macosko, E.Z.,
    Welch, J.D.: Jointly defining cell types from multiple single-cell datasets using
    liger. Nature protocols 15(11), 3632–3662 (2020)'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Liu 等 [2020] Liu, J., Gao, C., Sodicoff, J., Kozareva, V., Macosko, E.Z., Welch,
    J.D.: 使用 Liger 从多个单细胞数据集中联合定义细胞类型。Nature protocols 15(11), 3632–3662 (2020)'
- en: 'Hie et al. [2019] Hie, B., Bryson, B., Berger, B.: Efficient integration of
    heterogeneous single-cell transcriptomes using scanorama. Nature biotechnology
    37(6), 685–691 (2019)'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Hie 等 [2019] Hie, B., Bryson, B., Berger, B.: 使用 Scanorama 高效整合异质单细胞转录组。Nature
    biotechnology 37(6), 685–691 (2019)'
- en: 'Korsunsky et al. [2019] Korsunsky, I., Millard, N., Fan, J., Slowikowski, K.,
    Zhang, F., Wei, K., Baglaenko, Y., Brenner, M., Loh, P.-r., Raychaudhuri, S.:
    Fast, sensitive and accurate integration of single-cell data with harmony. Nature
    methods 16(12), 1289–1296 (2019)'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Korsunsky 等 [2019] Korsunsky, I., Millard, N., Fan, J., Slowikowski, K., Zhang,
    F., Wei, K., Baglaenko, Y., Brenner, M., Loh, P.-r., Raychaudhuri, S.: 使用 Harmony
    快速、敏感且准确地整合单细胞数据。Nature methods 16(12), 1289–1296 (2019)'
- en: 'Johnson et al. [2007] Johnson, W.E., Li, C., Rabinovic, A.: Adjusting batch
    effects in microarray expression data using empirical bayes methods. Biostatistics
    8(1), 118–127 (2007)'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Johnson 等 [2007] Johnson, W.E., Li, C., Rabinovic, A.: 使用经验贝叶斯方法调整微阵列表达数据中的批次效应。Biostatistics
    8(1), 118–127 (2007)'
- en: 'Büttner et al. [2019] Büttner, M., Miao, Z., Wolf, F.A., Teichmann, S.A., Theis,
    F.J.: A test metric for assessing single-cell rna-seq batch correction. Nature
    methods 16(1), 43–49 (2019)'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Büttner 等 [2019] Büttner, M., Miao, Z., Wolf, F.A., Teichmann, S.A., Theis,
    F.J.: 评估单细胞 RNA-seq 批次校正的测试度量。Nature methods 16(1), 43–49 (2019)'
- en: 'Korsunsky et al. [2019] Korsunsky, I., Millard, N., Fan, J., Slowikowski, K.,
    Zhang, F., Wei, K., Baglaenko, Y., Brenner, M., Loh, P.-r., Raychaudhuri, S.:
    Fast, sensitive and accurate integration of single-cell data with harmony. Nature
    methods 16(12), 1289–1296 (2019)'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Korsunsky 等 [2019] Korsunsky, I., Millard, N., Fan, J., Slowikowski, K., Zhang,
    F., Wei, K., Baglaenko, Y., Brenner, M., Loh, P.-r., Raychaudhuri, S.: 使用 Harmony
    快速、敏感且准确地整合单细胞数据。Nature methods 16(12), 1289–1296 (2019)'
- en: 'Hubert and Arabie [1985] Hubert, L., Arabie, P.: Comparing partitions. Journal
    of classification 2, 193–218 (1985)'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Hubert 和 Arabie [1985] Hubert, L., Arabie, P.: 比较划分。Journal of classification
    2, 193–218 (1985)'
- en: 'Hou and Ji [2024] Hou, W., Ji, Z.: Assessing gpt-4 for cell type annotation
    in single-cell rna-seq analysis. Nature Methods, 1–4 (2024)'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Hou 和 Ji [2024] Hou, W., Ji, Z.: 评估 gpt-4 在单细胞 RNA-seq 分析中的细胞类型注释。Nature Methods,
    1–4 (2024)'
- en: 'Zheng et al. [2017] Zheng, G.X., Terry, J.M., Belgrader, P., Ryvkin, P., Bent,
    Z.W., Wilson, R., Ziraldo, S.B., Wheeler, T.D., McDermott, G.P., Zhu, J., et al.:
    Massively parallel digital transcriptional profiling of single cells. Nature communications
    8(1), 14049 (2017)'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Zheng 等 [2017] Zheng, G.X., Terry, J.M., Belgrader, P., Ryvkin, P., Bent, Z.W.,
    Wilson, R., Ziraldo, S.B., Wheeler, T.D., McDermott, G.P., Zhu, J., 等: 单细胞的大规模平行数字转录组分析。Nature
    communications 8(1), 14049 (2017)'
- en: 'van Galen et al. [2019] Galen, P., Hovestadt, V., Wadsworth II, M.H., Hughes,
    T.K., Griffin, G.K., Battaglia, S., Verga, J.A., Stephansky, J., Pastika, T.J.,
    Story, J.L., et al.: Single-cell rna-seq reveals aml hierarchies relevant to disease
    progression and immunity. Cell 176(6), 1265–1281 (2019)'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'van Galen 等 [2019] Galen, P., Hovestadt, V., Wadsworth II, M.H., Hughes, T.K.,
    Griffin, G.K., Battaglia, S., Verga, J.A., Stephansky, J., Pastika, T.J., Story,
    J.L., 等: 单细胞 RNA-seq 揭示了与疾病进展和免疫相关的 AML 层次结构。Cell 176(6), 1265–1281 (2019)'
- en: 'Luecken et al. [2022] Luecken, M.D., Büttner, M., Chaichoompu, K., Danese,
    A., Interlandi, M., Müller, M.F., Strobl, D.C., Zappia, L., Dugas, M., Colomé-Tatché,
    M., et al.: Benchmarking atlas-level data integration in single-cell genomics.
    Nature methods 19(1), 41–50 (2022)'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Luecken 等 [2022] Luecken, M.D., Büttner, M., Chaichoompu, K., Danese, A., Interlandi,
    M., Müller, M.F., Strobl, D.C., Zappia, L., Dugas, M., Colomé-Tatché, M., 等: 单细胞基因组学中
    atlas 级数据整合的基准测试。Nature methods 19(1), 41–50 (2022)'
- en: 'Muraro et al. [2016] Muraro, M.J., Dharmadhikari, G., Grün, D., Groen, N.,
    Dielen, T., Jansen, E., Van Gurp, L., Engelse, M.A., Carlotti, F., De Koning,
    E.J., et al.: A single-cell transcriptome atlas of the human pancreas. Cell systems
    3(4), 385–394 (2016)'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Muraro et al. [2016] Muraro, M.J., Dharmadhikari, G., Grün, D., Groen, N., Dielen,
    T., Jansen, E., Van Gurp, L., Engelse, M.A., Carlotti, F., De Koning, E.J., 等：人类胰腺的单细胞转录组图谱。细胞系统
    3（4），385–394（2016）
- en: 'Macosko et al. [2015] Macosko, E.Z., Basu, A., Satija, R., Nemesh, J., Shekhar,
    K., Goldman, M., Tirosh, I., Bialas, A.R., Kamitaki, N., Martersteck, E.M., et
    al.: Highly parallel genome-wide expression profiling of individual cells using
    nanoliter droplets. Cell 161(5), 1202–1214 (2015)'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Macosko et al. [2015] Macosko, E.Z., Basu, A., Satija, R., Nemesh, J., Shekhar,
    K., Goldman, M., Tirosh, I., Bialas, A.R., Kamitaki, N., Martersteck, E.M., 等：使用纳升液滴进行的高度平行全基因组表达谱分析。细胞
    161（5），1202–1214（2015）
- en: 'Saelens et al. [2019] Saelens, W., Cannoodt, R., Todorov, H., Saeys, Y.: A
    comparison of single-cell trajectory inference methods. Nature biotechnology 37(5),
    547–554 (2019)'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Saelens et al. [2019] Saelens, W., Cannoodt, R., Todorov, H., Saeys, Y.: 单细胞轨迹推断方法的比较。自然生物技术
    37（5），547–554（2019）'
- en: 'Todorov et al. [2020] Todorov, H., Cannoodt, R., Saelens, W., Saeys, Y.: Tinga:
    fast and flexible trajectory inference with growing neural gas. Bioinformatics
    36(Supplement_1), 66–74 (2020)'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Todorov et al. [2020] Todorov, H., Cannoodt, R., Saelens, W., Saeys, Y.: Tinga:
    快速灵活的轨迹推断与生长神经气体。生物信息学 36（补刊_1），66–74（2020）'
- en: 'Grün et al. [2016] Grün, D., Muraro, M.J., Boisset, J.-C., Wiebrands, K., Lyubimova,
    A., Dharmadhikari, G., Born, M., Van Es, J., Jansen, E., Clevers, H., et al.:
    De novo prediction of stem cell identity using single-cell transcriptome data.
    Cell stem cell 19(2), 266–277 (2016)'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Grün et al. [2016] Grün, D., Muraro, M.J., Boisset, J.-C., Wiebrands, K., Lyubimova,
    A., Dharmadhikari, G., Born, M., Van Es, J., Jansen, E., Clevers, H., 等：使用单细胞转录组数据的新预测干细胞身份。细胞干细胞
    19（2），266–277（2016）
- en: 'Cannoodt et al. [2016] Cannoodt, R., Saelens, W., Sichien, D., Tavernier, S.,
    Janssens, S., Guilliams, M., Lambrecht, B., Preter, K.D., Saeys, Y.: Scorpius
    improves trajectory inference and identifies novel modules in dendritic cell development.
    Biorxiv, 079509 (2016)'
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Cannoodt et al. [2016] Cannoodt, R., Saelens, W., Sichien, D., Tavernier, S.,
    Janssens, S., Guilliams, M., Lambrecht, B., Preter, K.D., Saeys, Y.: Scorpius改进了轨迹推断并识别了树突状细胞发展中的新模块。Biorxiv,
    079509（2016）'
- en: 'Wolf et al. [2019] Wolf, F.A., Hamey, F.K., Plass, M., Solana, J., Dahlin,
    J.S., Göttgens, B., Rajewsky, N., Simon, L., Theis, F.J.: Paga: graph abstraction
    reconciles clustering with trajectory inference through a topology preserving
    map of single cells. Genome biology 20, 1–9 (2019)'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Wolf et al. [2019] Wolf, F.A., Hamey, F.K., Plass, M., Solana, J., Dahlin,
    J.S., Göttgens, B., Rajewsky, N., Simon, L., Theis, F.J.: Paga：图形抽象通过保持单细胞的拓扑图解调群集与轨迹推断。基因组生物学
    20，1–9（2019）'
- en: 'Street et al. [2018] Street, K., Risso, D., Fletcher, R.B., Das, D., Ngai,
    J., Yosef, N., Purdom, E., Dudoit, S.: Slingshot: cell lineage and pseudotime
    inference for single-cell transcriptomics. BMC genomics 19, 1–16 (2018)'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Street et al. [2018] Street, K., Risso, D., Fletcher, R.B., Das, D., Ngai,
    J., Yosef, N., Purdom, E., Dudoit, S.: Slingshot：单细胞转录组学的细胞谱系与伪时间推断。BMC基因组学 19，1–16（2018）'
- en: 'Büttner et al. [2019] Büttner, M., Miao, Z., Wolf, F.A., Teichmann, S.A., Theis,
    F.J.: A test metric for assessing single-cell rna-seq batch correction. Nature
    methods 16(1), 43–49 (2019)'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Büttner et al. [2019] Büttner, M., Miao, Z., Wolf, F.A., Teichmann, S.A., Theis,
    F.J.: 评估单细胞RNA-seq批次校正的测试指标。自然方法 16（1），43–49（2019）'
- en: 'Pedregosa et al. [2011] Pedregosa, F., Varoquaux, G., Gramfort, A., Michel,
    V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg,
    V., et al.: Scikit-learn: Machine learning in python. the Journal of machine Learning
    research 12, 2825–2830 (2011)'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Pedregosa et al. [2011] Pedregosa, F., Varoquaux, G., Gramfort, A., Michel,
    V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg,
    V., 等：Scikit-learn：Python中的机器学习。机器学习研究杂志 12，2825–2830（2011）
